date,Host,Service,message
2021-12-02T17:16:17.748Z,gke-platform-prod-clus-np-preemptible-c4954949-rkfw.c.platform-prod-399563.internal,epub_data_service:celerybeat,"Database gave error: OperationalError('terminating connection due to administrator command
SSL connection has been closed unexpectedly
')"
2021-12-02T17:16:07.998Z,gke-platform-prod-cluster-np-01-bffac76f-cswp.c.platform-prod-399563.internal,epub_data_service:content,"{""asctime"": ""2021-12-02T17:16:07.488"", ""module"": ""log"", ""levelname"": ""ERROR"", ""message"": ""Internal Server Error: /api/v2/epubs/urn:orm:book:9781839216541/files/Text/Chapter_6.xhtml"", ""exc_info"": ""Traceback (most recent call last):
  File \""/usr/local/lib/python3.10/site-packages/django/db/models/fields/related_descriptors.py\"", line 173, in __get__
    rel_obj = self.field.get_cached_value(instance)
  File \""/usr/local/lib/python3.10/site-packages/django/db/models/fields/mixins.py\"", line 15, in get_cached_value
    return instance._state.fields_cache[cache_name]
KeyError: 'epub_archive'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File \""/usr/local/lib/python3.10/site-packages/django/db/backends/utils.py\"", line 84, in _execute
    return self.cursor.execute(sql, params)
  File \""/usr/local/lib/python3.10/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 112, in execute
    return self._trace_method(self.__wrapped__.execute, self._self_datadog_name, query, {}, query, *args, **kwargs)
  File \""/usr/local/lib/python3.10/site-packages/ddtrace/contrib/psycopg/patch.py\"", line 59, in _trace_method
    return super(Psycopg2TracedCursor, self)._trace_method(method, name, resource, extra_tags, *args, **kwargs)
  File \""/usr/local/lib/python3.10/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 75, in _trace_method
    return method(*args, **kwargs)
psycopg2.errors.AdminShutdown: terminating connection due to administrator command
SSL connection has been closed unexpectedly


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File \""/usr/local/lib/python3.10/site-packages/django/core/handlers/exception.py\"", line 47, in inner
    response = get_response(request)
  File \""/usr/local/lib/python3.10/site-packages/django/core/handlers/base.py\"", line 181, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File \""/usr/local/lib/python3.10/site-packages/sentry_sdk/integrations/django/views.py\"", line 67, in sentry_wrapped_callback
    return callback(request, *args, **kwargs)
  File \""/usr/local/lib/python3.10/site-packages/ddtrace/contrib/trace_utils.py\"", line 162, in wrapper
    return func(mod, pin, wrapped, instance, args, kwargs)
  File \""/usr/local/lib/python3.10/site-packages/ddtrace/contrib/django/patch.py\"", line 213, in wrapped
    return func(*args, **kwargs)
  File \""/usr/local/lib/python3.10/site-packages/django/views/decorators/csrf.py\"", line 54, in wrapped_view
    return view_func(*args, **kwargs)
  File \""/usr/local/lib/python3.10/site-packages/rest_framework/viewsets.py\"", line 125, in view
    return self.dispatch(request, *args, **kwargs)
  File \""/usr/local/lib/python3.10/site-packages/ddtrace/contrib/trace_utils.py\"", line 162, in wrapper
    return func(mod, pin, wrapped, instance, args, kwargs)
  File \""/usr/local/lib/python3.10/site-packages/ddtrace/contrib/django/patch.py\"", line 213, in wrapped
    return func(*args, **kwargs)
  File \""/usr/local/lib/python3.10/site-packages/rest_framework/views.py\"", line 509, in dispatch
    response = self.handle_exception(exc)
  File \""/usr/local/lib/python3.10/site-packages/ddtrace/contrib/trace_utils.py\"", line 162, in wrapper
    return func(mod, pin, wrapped, instance, args, kwargs)
  File \""/usr/local/lib/python3.10/site-packages/ddtrace/contrib/django/restframework.py\"", line 19, in _traced_handle_exception
    return wrapped(*args, **kwargs)
  File \""/usr/local/lib/python3.10/site-packages/rest_framework/views.py\"", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File \""/usr/local/lib/python3.10/site-packages/rest_framework/views.py\"", line 480, in raise_uncaught_exception
    raise exc
  File \""/usr/local/lib/python3.10/site-packages/rest_framework/views.py\"", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File \""/orm/service/./api/viewsets.py\"", line 168, in content
    response = HttpResponse(content, content_type=media_type)
  File \""/usr/local/lib/python3.10/site-packages/django/http/response.py\"", line 331, in __init__
    self.content = content
  File \""/usr/local/lib/python3.10/site-packages/django/http/response.py\"", line 364, in content
    content = self.make_bytes(value)
  File \""/usr/local/lib/python3.10/site-packages/django/http/response.py\"", line 276, in make_bytes
    return str(value).encode(self.charset)
  File \""/usr/local/lib/python3.10/site-packages/epub/chapter.py\"", line 121, in __str__
    body = self.render_content()
  File \""/usr/local/lib/python3.10/site-packages/epub/chapter.py\"", line 111, in render_content
    self.apply_transforms()
  File \""/usr/local/lib/python3.10/site-packages/epub/chapter.py\"", line 98, in apply_transforms
    method()
  File \""/orm/service/./epubs/content_processors.py\"", line 104, in rewrite_src_transform
    chapter.epub_archive.epub_files.filter(full_path__in=path_mapping.values()).values(
  File \""/usr/local/lib/python3.10/site-packages/django/db/models/fields/related_descriptors.py\"", line 187, in __get__
    rel_obj = self.get_object(instance)
  File \""/usr/local/lib/python3.10/site-packages/django/db/models/fields/related_descriptors.py\"", line 154, in get_object
    return qs.get(self.field.get_reverse_related_filter(instance))
  File \""/usr/local/lib/python3.10/site-packages/django/db/models/query.py\"", line 431, in get
    num = len(clone)
  File \""/usr/local/lib/python3.10/site-packages/django/db/models/query.py\"", line 262, in __len__
    self._fetch_all()
  File \""/usr/local/lib/python3.10/site-packages/django/db/models/query.py\"", line 1324, in _fetch_all
    self._result_cache = list(self._iterable_class(self))
  File \""/usr/local/lib/python3.10/site-packages/django/db/models/query.py\"", line 51, in __iter__
    results = compiler.execute_sql(chunked_fetch=self.chunked_fetch, chunk_size=self.chunk_size)
  File \""/usr/local/lib/python3.10/site-packages/django/db/models/sql/compiler.py\"", line 1175, in execute_sql
    cursor.execute(sql, params)
  File \""/usr/local/lib/python3.10/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 112, in execute
    return self._trace_method(self.__wrapped__.execute, self._self_datadog_name, query, {}, query, *args, **kwargs)
  File \""/usr/local/lib/python3.10/site-packages/ddtrace/contrib/psycopg/patch.py\"", line 59, in _trace_method
    return super(Psycopg2TracedCursor, self)._trace_method(method, name, resource, extra_tags, *args, **kwargs)
  File \""/usr/local/lib/python3.10/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 75, in _trace_method
    return method(*args, **kwargs)
  File \""/usr/local/lib/python3.10/site-packages/sentry_sdk/integrations/django/__init__.py\"", line 500, in execute
    return real_execute(self, sql, params)
  File \""/usr/local/lib/python3.10/site-packages/django/db/backends/utils.py\"", line 66, in execute
    return self._execute_with_wrappers(sql, params, many=False, executor=self._execute)
  File \""/usr/local/lib/python3.10/site-packages/django/db/backends/utils.py\"", line 75, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File \""/usr/local/lib/python3.10/site-packages/django/db/backends/utils.py\"", line 79, in _execute
    with self.db.wrap_database_errors:
  File \""/usr/local/lib/python3.10/site-packages/django/db/utils.py\"", line 90, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File \""/usr/local/lib/python3.10/site-packages/django/db/backends/utils.py\"", line 84, in _execute
    return self.cursor.execute(sql, params)
  File \""/usr/local/lib/python3.10/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 112, in execute
    return self._trace_method(self.__wrapped__.execute, self._self_datadog_name, query, {}, query, *args, **kwargs)
  File \""/usr/local/lib/python3.10/site-packages/ddtrace/contrib/psycopg/patch.py\"", line 59, in _trace_method
    return super(Psycopg2TracedCursor, self)._trace_method(method, name, resource, extra_tags, *args, *{""asctime"":""2021-12-02T17:16:07+0000"", ""message"":""[pid: 8|app: 0|req: 397/754] 119.247.31.74 () {102 vars in 4744 bytes} [Thu Dec  2 17:16:06 2021] GET /api/v2/epubs/urn:orm:book:9781484251362/files/images/336364_2_En_6_Chapter/336364_2_En_6_Fig20_HTML.jpg => generated 145 bytes in 495 msecs (HTTP/1.1 500) 7 headers in 233 bytes (1 switches on core 0)""}"
2021-12-02T17:16:07.642Z,gke-platform-prod-clus-np-preemptible-c4954949-rkfw.c.platform-prod-399563.internal,epub_data_service:celerybeat,"Database gave error: OperationalError('terminating connection due to administrator command
SSL connection has been closed unexpectedly
')"
2021-12-02T17:16:07.468Z,gke-platform-prod-cluster-np-01-d54e11d6-etk7.c.platform-prod-399563.internal,epub_data_service:content,"{""asctime"": ""2021-12-02T17:16:07.191"", ""module"": ""log"", ""levelname"": ""ERROR"", ""message"": ""Internal Server Error: /api/v2/epubs/urn:orm:book:9781788835466/files/f6d7a7be-d6b8-40ca-9839-b161055554e9.xhtml"", ""exc_info"": ""Traceback (most recent call last):
  File \""/usr/local/lib/python3.10/site-packages/django/db/models/fields/related_descriptors.py\"", line 173, in __get__
    rel_obj = self.field.get_cached_value(instance)
  File \""/usr/local/lib/python3.10/site-packages/django/db/models/fields/mixins.py\"", line 15, in get_cached_value
    return instance._state.fields_cache[cache_name]
KeyError: 'epub_archive'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File \""/usr/local/lib/python3.10/site-packages/django/db/backends/utils.py\"", line 84, in _execute
    return self.cursor.execute(sql, params)
  File \""/usr/local/lib/python3.10/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 112, in execute
    return self._trace_method(self.__wrapped__.execute, self._self_datadog_name, query, {}, query, *args, **kwargs)
  File \""/usr/local/lib/python3.10/site-packages/ddtrace/contrib/psycopg/patch.py\"", line 59, in _trace_method
    return super(Psycopg2TracedCursor, self)._trace_method(method, name, resource, extra_tags, *args, **kwargs)
  File \""/usr/local/lib/python3.10/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 75, in _trace_method
    return method(*args, **kwargs)
psycopg2.errors.AdminShutdown: terminating connection due to administrator command
SSL connection has been closed unexpectedly


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File \""/usr/local/lib/python3.10/site-packages/django/core/handlers/exception.py\"", line 47, in inner
    response = get_response(request)
  File \""/usr/local/lib/python3.10/site-packages/django/core/handlers/base.py\"", line 181, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File \""/usr/local/lib/python3.10/site-packages/sentry_sdk/integrations/django/views.py\"", line 67, in sentry_wrapped_callback
    return callback(request, *args, **kwargs)
  File \""/usr/local/lib/python3.10/site-packages/ddtrace/contrib/trace_utils.py\"", line 162, in wrapper
    return func(mod, pin, wrapped, instance, args, kwargs)
  File \""/usr/local/lib/python3.10/site-packages/ddtrace/contrib/django/patch.py\"", line 213, in wrapped
    return func(*args, **kwargs)
  File \""/usr/local/lib/python3.10/site-packages/django/views/decorators/csrf.py\"", line 54, in wrapped_view
    return view_func(*args, **kwargs)
  File \""/usr/local/lib/python3.10/site-packages/rest_framework/viewsets.py\"", line 125, in view
    return self.dispatch(request, *args, **kwargs)
  File \""/usr/local/lib/python3.10/site-packages/ddtrace/contrib/trace_utils.py\"", line 162, in wrapper
    return func(mod, pin, wrapped, instance, args, kwargs)
  File \""/usr/local/lib/python3.10/site-packages/ddtrace/contrib/django/patch.py\"", line 213, in wrapped
    return func(*args, **kwargs)
  File \""/usr/local/lib/python3.10/site-packages/rest_framework/views.py\"", line 509, in dispatch
    response = self.handle_exception(exc)
  File \""/usr/local/lib/python3.10/site-packages/ddtrace/contrib/trace_utils.py\"", line 162, in wrapper
    return func(mod, pin, wrapped, instance, args, kwargs)
  File \""/usr/local/lib/python3.10/site-packages/ddtrace/contrib/django/restframework.py\"", line 19, in _traced_handle_exception
    return wrapped(*args, **kwargs)
  File \""/usr/local/lib/python3.10/site-packages/rest_framework/views.py\"", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File \""/usr/local/lib/python3.10/site-packages/rest_framework/views.py\"", line 480, in raise_uncaught_exception
    raise exc
  File \""/usr/local/lib/python3.10/site-packages/rest_framework/views.py\"", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File \""/orm/service/./api/viewsets.py\"", line 168, in content
    response = HttpResponse(content, content_type=media_type)
  File \""/usr/local/lib/python3.10/site-packages/django/http/response.py\"", line 331, in __init__
    self.content = content
  File \""/usr/local/lib/python3.10/site-packages/django/http/response.py\"", line 364, in content
    content = self.make_bytes(value)
  File \""/usr/local/lib/python3.10/site-packages/django/http/response.py\"", line 276, in make_bytes
    return str(value).encode(self.charset)
  File \""/usr/local/lib/python3.10/site-packages/epub/chapter.py\"", line 121, in __str__
    body = self.render_content()
  File \""/usr/local/lib/python3.10/site-packages/epub/chapter.py\"", line 111, in render_content
    self.apply_transforms()
  File \""/usr/local/lib/python3.10/site-packages/epub/chapter.py\"", line 98, in apply_transforms
    method()
  File \""/orm/service/./epubs/content_processors.py\"", line 104, in rewrite_src_transform
    chapter.epub_archive.epub_files.filter(full_path__in=path_mapping.values()).values(
  File \""/usr/local/lib/python3.10/site-packages/django/db/models/fields/related_descriptors.py\"", line 187, in __get__
    rel_obj = self.get_object(instance)
  File \""/usr/local/lib/python3.10/site-packages/django/db/models/fields/related_descriptors.py\"", line 154, in get_object
    return qs.get(self.field.get_reverse_related_filter(instance))
  File \""/usr/local/lib/python3.10/site-packages/django/db/models/query.py\"", line 431, in get
    num = len(clone)
  File \""/usr/local/lib/python3.10/site-packages/django/db/models/query.py\"", line 262, in __len__
    self._fetch_all()
  File \""/usr/local/lib/python3.10/site-packages/django/db/models/query.py\"", line 1324, in _fetch_all
    self._result_cache = list(self._iterable_class(self))
  File \""/usr/local/lib/python3.10/site-packages/django/db/models/query.py\"", line 51, in __iter__
    results = compiler.execute_sql(chunked_fetch=self.chunked_fetch, chunk_size=self.chunk_size)
  File \""/usr/local/lib/python3.10/site-packages/django/db/models/sql/compiler.py\"", line 1175, in execute_sql
    cursor.execute(sql, params)
  File \""/usr/local/lib/python3.10/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 112, in execute
    return self._trace_method(self.__wrapped__.execute, self._self_datadog_name, query, {}, query, *args, **kwargs)
  File \""/usr/local/lib/python3.10/site-packages/ddtrace/contrib/psycopg/patch.py\"", line 59, in _trace_method
    return super(Psycopg2TracedCursor, self)._trace_method(method, name, resource, extra_tags, *args, **kwargs)
  File \""/usr/local/lib/python3.10/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 75, in _trace_method
    return method(*args, **kwargs)
  File \""/usr/local/lib/python3.10/site-packages/sentry_sdk/integrations/django/__init__.py\"", line 500, in execute
    return real_execute(self, sql, params)
  File \""/usr/local/lib/python3.10/site-packages/django/db/backends/utils.py\"", line 66, in execute
    return self._execute_with_wrappers(sql, params, many=False, executor=self._execute)
  File \""/usr/local/lib/python3.10/site-packages/django/db/backends/utils.py\"", line 75, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File \""/usr/local/lib/python3.10/site-packages/django/db/backends/utils.py\"", line 79, in _execute
    with self.db.wrap_database_errors:
  File \""/usr/local/lib/python3.10/site-packages/django/db/utils.py\"", line 90, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File \""/usr/local/lib/python3.10/site-packages/django/db/backends/utils.py\"", line 84, in _execute
    return self.cursor.execute(sql, params)
  File \""/usr/local/lib/python3.10/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 112, in execute
    return self._trace_method(self.__wrapped__.execute, self._self_datadog_name, query, {}, query, *args, **kwargs)
  File \""/usr/local/lib/python3.10/site-packages/ddtrace/contrib/psycopg/patch.py\"", line 59, in _trace_method
    return super(Psycopg2TracedCursor, self)._trace_method(method, name, resource{""asctime"":""2021-12-02T17:16:07+0000"", ""message"":""[pid: 8|app: 0|req: 3145/6033] 194.166.216.203 () {110 vars in 5289 bytes} [Thu Dec  2 17:16:06 2021] GET /api/v2/epubs/urn:orm:book:9781788835466/files/f6d7a7be-d6b8-40ca-9839-b161055554e9.xhtml => generated 145 bytes in 399 msecs (HTTP/1.1 500) 7 headers in 224 bytes (1 switches on core 0)""}"
2021-12-02T17:13:31.304Z,gke-platform-prod-clus-np-preemptible-86705b90-gsm1.c.platform-prod-399563.internal,cowbird:celerybeat,"Database gave error: OperationalError('terminating connection due to administrator command
SSL connection has been closed unexpectedly
')"
2021-12-02T17:13:21.108Z,gke-platform-prod-clus-np-preemptible-86705b90-gsm1.c.platform-prod-399563.internal,cowbird:celerybeat,"Database gave error: OperationalError('terminating connection due to administrator command
SSL connection has been closed unexpectedly
')"
2021-12-02T17:05:10.350Z,gke-platform-prod-clus-np-preemptible-c4954949-rkfw.c.platform-prod-399563.internal,content_submission_service:celerybeat,"Database gave error: OperationalError('terminating connection due to administrator command
SSL connection has been closed unexpectedly
')"
2021-12-02T17:04:59.997Z,gke-platform-prod-clus-np-preemptible-c4954949-rkfw.c.platform-prod-399563.internal,content_submission_service:celerybeat,"Database gave error: OperationalError('terminating connection due to administrator command
SSL connection has been closed unexpectedly
')"
2021-12-02T16:59:00.048Z,gke-platform-prod-clus-np-preemptible-3d7a4575-lq4w.c.platform-prod-399563.internal,content_metabase:metabase,Caused by: org.postgresql.util.PSQLException: FATAL: terminating connection due to administrator command
2021-12-02T16:59:00.048Z,gke-platform-prod-clus-np-preemptible-3d7a4575-lq4w.c.platform-prod-399563.internal,content_metabase:metabase,org.quartz.JobPersistenceException: Failure identifying failed instances when checking-in: FATAL: terminating connection due to administrator command [See nested exception: org.postgresql.util.PSQLException: FATAL: terminating connection due to administrator command]
2021-12-02T16:59:00.048Z,gke-platform-prod-clus-np-preemptible-3d7a4575-lq4w.c.platform-prod-399563.internal,content_metabase:metabase,"2021-12-02 16:58:59,836 ERROR jdbcjobstore.JobStoreTX :: ClusterManager: Error managing cluster: Failure identifying failed instances when checking-in: FATAL: terminating connection due to administrator command"
2021-12-02T16:58:22.043Z,gke-platform-prod-clus-np-preemptible-3d7a4575-lq4w.c.platform-prod-399563.internal,content_metabase:metabase,Caused by: org.postgresql.util.PSQLException: FATAL: terminating connection due to administrator command
2021-12-02T16:58:22.043Z,gke-platform-prod-clus-np-preemptible-3d7a4575-lq4w.c.platform-prod-399563.internal,content_metabase:metabase,org.quartz.JobPersistenceException: Failure identifying failed instances when checking-in: FATAL: terminating connection due to administrator command [See nested exception: org.postgresql.util.PSQLException: FATAL: terminating connection due to administrator command]
2021-12-02T16:58:22.043Z,gke-platform-prod-clus-np-preemptible-3d7a4575-lq4w.c.platform-prod-399563.internal,content_metabase:metabase,"2021-12-02 16:58:21,888 ERROR jdbcjobstore.JobStoreTX :: ClusterManager: Error managing cluster: Failure identifying failed instances when checking-in: FATAL: terminating connection due to administrator command"
2021-12-02T16:38:27.727Z,gke-platform-prod-cluster-np-01-d54e11d6-p4tu.c.platform-prod-399563.internal,live_event_user_registration_service:celery,"Task live_event_user_registration_service.tasks.update_or_delete_registration[1f06abb5-ffc4-4bed-87a7-fa506c678301] raised unexpected: OperationalError('terminating connection due to administrator command
SSL connection has been closed unexpectedly
')"
2021-12-02T16:38:15.999Z,gke-platform-prod-cluster-np-01-d54e11d6-p4tu.c.platform-prod-399563.internal,live_event_user_registration_service:celery,"Task live_event_user_registration_service.tasks.update_or_delete_registration[da194406-47cc-4c3b-a322-d0d3fb75326c] raised unexpected: OperationalError('terminating connection due to administrator command
SSL connection has been closed unexpectedly
')"
2021-12-02T16:38:10.417Z,gke-platform-prod-cluster-np-01-bffac76f-t23s.c.platform-prod-399563.internal,live_event_user_registration_service:http,"{""asctime"": ""2021-12-02T16:38:09.934"", ""module"": ""log"", ""levelname"": ""ERROR"", ""message"": ""Internal Server Error: /api/v1/live-event-user-registration/events/"", ""exc_info"": ""Traceback (most recent call last):
  File \""/usr/local/lib/python3.10/site-packages/django/db/backends/utils.py\"", line 84, in _execute
    return self.cursor.execute(sql, params)
  File \""/usr/local/lib/python3.10/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 112, in execute
    return self._trace_method(self.__wrapped__.execute, self._self_datadog_name, query, {}, query, *args, **kwargs)
  File \""/usr/local/lib/python3.10/site-packages/ddtrace/contrib/psycopg/patch.py\"", line 59, in _trace_method
    return super(Psycopg2TracedCursor, self)._trace_method(method, name, resource, extra_tags, *args, **kwargs)
  File \""/usr/local/lib/python3.10/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 75, in _trace_method
    return method(*args, **kwargs)
psycopg2.errors.AdminShutdown: terminating connection due to administrator command
SSL connection has been closed unexpectedly


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File \""/usr/local/lib/python3.10/site-packages/django/core/handlers/exception.py\"", line 47, in inner
    response = get_response(request)
  File \""/usr/local/lib/python3.10/site-packages/django/core/handlers/base.py\"", line 181, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File \""/usr/local/lib/python3.10/site-packages/sentry_sdk/integrations/django/views.py\"", line 67, in sentry_wrapped_callback
    return callback(request, *args, **kwargs)
  File \""/usr/local/lib/python3.10/site-packages/ddtrace/contrib/trace_utils.py\"", line 162, in wrapper
    return func(mod, pin, wrapped, instance, args, kwargs)
  File \""/usr/local/lib/python3.10/site-packages/ddtrace/contrib/django/patch.py\"", line 213, in wrapped
    return func(*args, **kwargs)
  File \""/usr/local/lib/python3.10/site-packages/django/views/decorators/csrf.py\"", line 54, in wrapped_view
    return view_func(*args, **kwargs)
  File \""/usr/local/lib/python3.10/site-packages/rest_framework/viewsets.py\"", line 125, in view
    return self.dispatch(request, *args, **kwargs)
  File \""/usr/local/lib/python3.10/site-packages/ddtrace/contrib/trace_utils.py\"", line 162, in wrapper
    return func(mod, pin, wrapped, instance, args, kwargs)
  File \""/usr/local/lib/python3.10/site-packages/ddtrace/contrib/django/patch.py\"", line 213, in wrapped
    return func(*args, **kwargs)
  File \""/usr/local/lib/python3.10/site-packages/rest_framework/views.py\"", line 509, in dispatch
    response = self.handle_exception(exc)
  File \""/usr/local/lib/python3.10/site-packages/ddtrace/contrib/trace_utils.py\"", line 162, in wrapper
    return func(mod, pin, wrapped, instance, args, kwargs)
  File \""/usr/local/lib/python3.10/site-packages/ddtrace/contrib/django/restframework.py\"", line 19, in _traced_handle_exception
    return wrapped(*args, **kwargs)
  File \""/usr/local/lib/python3.10/site-packages/rest_framework/views.py\"", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File \""/usr/local/lib/python3.10/site-packages/rest_framework/views.py\"", line 480, in raise_uncaught_exception
    raise exc
  File \""/usr/local/lib/python3.10/site-packages/rest_framework/views.py\"", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File \""/usr/local/lib/python3.10/site-packages/rest_framework/mixins.py\"", line 38, in list
    queryset = self.filter_queryset(self.get_queryset())
  File \""/usr/local/lib/python3.10/site-packages/rest_framework/generics.py\"", line 150, in filter_queryset
    queryset = backend().filter_queryset(self.request, queryset, self)
  File \""/orm/service/api/views.py\"", line 91, in filter_queryset
    Producer.objects.get(user_uuid=request.user.id)
  File \""/usr/local/lib/python3.10/site-packages/django/db/models/manager.py\"", line 85, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
  File \""/usr/local/lib/python3.10/site-packages/django/db/models/query.py\"", line 431, in get
    num = len(clone)
  File \""/usr/local/lib/python3.10/site-packages/django/db/models/query.py\"", line 262, in __len__
    self._fetch_all()
  File \""/usr/local/lib/python3.10/site-packages/django/db/models/query.py\"", line 1324, in _fetch_all
    self._result_cache = list(self._iterable_class(self))
  File \""/usr/local/lib/python3.10/site-packages/django/db/models/query.py\"", line 51, in __iter__
    results = compiler.execute_sql(chunked_fetch=self.chunked_fetch, chunk_size=self.chunk_size)
  File \""/usr/local/lib/python3.10/site-packages/django/db/models/sql/compiler.py\"", line 1175, in execute_sql
    cursor.execute(sql, params)
  File \""/usr/local/lib/python3.10/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 112, in execute
    return self._trace_method(self.__wrapped__.execute, self._self_datadog_name, query, {}, query, *args, **kwargs)
  File \""/usr/local/lib/python3.10/site-packages/ddtrace/contrib/psycopg/patch.py\"", line 59, in _trace_method
    return super(Psycopg2TracedCursor, self)._trace_method(method, name, resource, extra_tags, *args, **kwargs)
  File \""/usr/local/lib/python3.10/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 75, in _trace_method
    return method(*args, **kwargs)
  File \""/usr/local/lib/python3.10/site-packages/sentry_sdk/integrations/django/__init__.py\"", line 500, in execute
    return real_execute(self, sql, params)
  File \""/usr/local/lib/python3.10/site-packages/django/db/backends/utils.py\"", line 66, in execute
    return self._execute_with_wrappers(sql, params, many=False, executor=self._execute)
  File \""/usr/local/lib/python3.10/site-packages/django/db/backends/utils.py\"", line 75, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File \""/usr/local/lib/python3.10/site-packages/django/db/backends/utils.py\"", line 79, in _execute
    with self.db.wrap_database_errors:
  File \""/usr/local/lib/python3.10/site-packages/django/db/utils.py\"", line 90, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File \""/usr/local/lib/python3.10/site-packages/django/db/backends/utils.py\"", line 84, in _execute
    return self.cursor.execute(sql, params)
  File \""/usr/local/lib/python3.10/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 112, in execute
    return self._trace_method(self.__wrapped__.execute, self._self_datadog_name, query, {}, query, *args, **kwargs)
  File \""/usr/local/lib/python3.10/site-packages/ddtrace/contrib/psycopg/patch.py\"", line 59, in _trace_method
    return super(Psycopg2TracedCursor, self)._trace_method(method, name, resource, extra_tags, *args, **kwargs)
  File \""/usr/local/lib/python3.10/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 75, in _trace_method
    return method(*args, **kwargs)
django.db.utils.OperationalError: terminating connection due to administrator command
SSL connection has been closed unexpectedly
"", ""status_code"": 500, ""request"": ""<WSGIRequest: GET '/api/v1/live-event-user-registration/events/?limit=100&product_identifiers=0636920064225,0636920064598,0636920063054,0636920064620,0636920058790,0636920061364,0636920064273,0636920063437,0636920066361,0636920064278,0636920064582,0636920063805,0636920064863,0636920064264,0636920064260,0636920061886,0636920064561,0636920062591,0636920062983,0636920063163,0636920064120,0636920062560,0636920062780,0636920062598,0636920064816,0636920062241,0636920063921,0636920064887,0636920064568,0636920064218,0636920064593,0636920063180,0636920064125,0636920057465,0636920064129,0636920061390,0636920062987,0636920062245,0636920064993,0636920064269,0636920064223,0636920064585,0636920064869,0636920065097,0636920064133,0636920064915,0636920064575,0636920061372,0636920061382,0636920061895,0636920061890,0636920063167,0636920061899,0636920061245,0636920062839,0636920061324,0636920064137,0636920064634,0636920065615,0636920064142,0636920063144,0636920061483,0636920064151,06369{""asctime"":""2021-12-02T16:38:09+0000"", ""message"":""[pid: 6|app: 0|req: 342525/1045929] 10.134.0.208 () {64 vars in 6528 bytes} [Thu Dec  2 16:38:09 2021] GET /api/v1/live-event-user-registration/events/?limit=100&product_identifiers=0636920064225,0636920064598,0636920063054,0636920064620,0636920058790,0636920061364,0636920064273,0636920063437,0636920066361,0636920064278,0636920064582,0636920063805,0636920064863,0636920064264,0636920064260,0636920061886,0636920064561,0636920062591,0636920062983,0636920063163,0636920064120,0636920062560,0636920062780,0636920062598,0636920064816,0636920062241,0636920063921,0636920064887,0636920064568,0636920064218,0636920064593,0636920063180,0636920064125,0636920057465,0636920064129,0636920061390,0636920062987,0636920062245,0636920064993,0636920064269,0636920064223,0636920064585,0636920064869,0636920065097,0636920064133,0636920064915,0636920064575,0636920061372,0636920061382,0636920061895,0636920061890,0636920063167,0636920061899,0636920061245,0636920062839,0636920061324,0636920064137,0636920064634,0636920065615,0636920064142,0636920063144,0636920061483,0636920064151,0636920064674,0636920066373,0636920064660,0636920064641,0636920064667,0636920062267,0636920064147,0636920064512,0636920062361,0636920064782,0636920061360,0636920062207,0636920063106,0636920064283,0636920064295,0636920063843,0636920064533,0636920061903,0636920064302,0636920064164,0636920063173,0636920062584,0636920063039,0636920064307,0636920064311,0636920062771,0636920062272,0636920065539,0636920062474,0636920053285,0636920062762,0636920065073,0636920066365,0636920064316,0636920064320,0636920061336,0636920062991 => generated 145 bytes in 71 msecs (HTTP/1.1 500) 7 headers in 235 bytes (1 switches on core 0)""}"
2021-12-02T16:38:10.230Z,gke-platform-prod-cluster-np-01-d54e11d6-p4tu.c.platform-prod-399563.internal,live_event_user_registration_service:celery,"Task live_event_user_registration_service.tasks.update_or_delete_registration[60f8a391-5d16-414d-8a6f-39e7eca730d6] raised unexpected: OperationalError('terminating connection due to administrator command
SSL connection has been closed unexpectedly
')"
2021-12-02T16:31:15.650Z,gke-platform-prod-cluster-np-01-3fe7d044-ekh9.c.platform-prod-399563.internal,live_event_metadata_service:http,"{""asctime"": ""2021-12-02T16:31:15.535"", ""module"": ""log"", ""levelname"": ""ERROR"", ""message"": ""Internal Server Error: /api/v1/live-events/"", ""exc_info"": ""Traceback (most recent call last):
  File \""/usr/local/lib/python3.10/site-packages/django/db/backends/utils.py\"", line 84, in _execute
    return self.cursor.execute(sql, params)
  File \""/usr/local/lib/python3.10/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 112, in execute
    return self._trace_method(self.__wrapped__.execute, self._self_datadog_name, query, {}, query, *args, **kwargs)
  File \""/usr/local/lib/python3.10/site-packages/ddtrace/contrib/psycopg/patch.py\"", line 59, in _trace_method
    return super(Psycopg2TracedCursor, self)._trace_method(method, name, resource, extra_tags, *args, **kwargs)
  File \""/usr/local/lib/python3.10/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 75, in _trace_method
    return method(*args, **kwargs)
psycopg2.errors.AdminShutdown: terminating connection due to administrator command
SSL connection has been closed unexpectedly


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File \""/usr/local/lib/python3.10/site-packages/django/core/handlers/exception.py\"", line 47, in inner
    response = get_response(request)
  File \""/usr/local/lib/python3.10/site-packages/django/core/handlers/base.py\"", line 181, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File \""/usr/local/lib/python3.10/site-packages/sentry_sdk/integrations/django/views.py\"", line 67, in sentry_wrapped_callback
    return callback(request, *args, **kwargs)
  File \""/usr/local/lib/python3.10/site-packages/ddtrace/contrib/trace_utils.py\"", line 162, in wrapper
    return func(mod, pin, wrapped, instance, args, kwargs)
  File \""/usr/local/lib/python3.10/site-packages/ddtrace/contrib/django/patch.py\"", line 213, in wrapped
    return func(*args, **kwargs)
  File \""/usr/local/lib/python3.10/site-packages/django/views/decorators/csrf.py\"", line 54, in wrapped_view
    return view_func(*args, **kwargs)
  File \""/usr/local/lib/python3.10/site-packages/rest_framework/viewsets.py\"", line 125, in view
    return self.dispatch(request, *args, **kwargs)
  File \""/usr/local/lib/python3.10/site-packages/ddtrace/contrib/trace_utils.py\"", line 162, in wrapper
    return func(mod, pin, wrapped, instance, args, kwargs)
  File \""/usr/local/lib/python3.10/site-packages/ddtrace/contrib/django/patch.py\"", line 213, in wrapped
    return func(*args, **kwargs)
  File \""/usr/local/lib/python3.10/site-packages/rest_framework/views.py\"", line 509, in dispatch
    response = self.handle_exception(exc)
  File \""/usr/local/lib/python3.10/site-packages/ddtrace/contrib/trace_utils.py\"", line 162, in wrapper
    return func(mod, pin, wrapped, instance, args, kwargs)
  File \""/usr/local/lib/python3.10/site-packages/ddtrace/contrib/django/restframework.py\"", line 19, in _traced_handle_exception
    return wrapped(*args, **kwargs)
  File \""/usr/local/lib/python3.10/site-packages/rest_framework/views.py\"", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File \""/usr/local/lib/python3.10/site-packages/rest_framework/views.py\"", line 480, in raise_uncaught_exception
    raise exc
  File \""/usr/local/lib/python3.10/site-packages/rest_framework/views.py\"", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File \""/usr/local/lib/python3.10/site-packages/rest_framework/mixins.py\"", line 40, in list
    page = self.paginate_queryset(queryset)
  File \""/usr/local/lib/python3.10/site-packages/rest_framework/generics.py\"", line 171, in paginate_queryset
    return self.paginator.paginate_queryset(queryset, self.request, view=self)
  File \""/usr/local/lib/python3.10/site-packages/rest_framework/pagination.py\"", line 395, in paginate_queryset
    return list(queryset[self.offset:self.offset + self.limit])
  File \""/usr/local/lib/python3.10/site-packages/django/db/models/query.py\"", line 262, in __len__
    self._fetch_all()
  File \""/usr/local/lib/python3.10/site-packages/django/db/models/query.py\"", line 1326, in _fetch_all
    self._prefetch_related_objects()
  File \""/usr/local/lib/python3.10/site-packages/django/db/models/query.py\"", line 813, in _prefetch_related_objects
    prefetch_related_objects(self._result_cache, *self._prefetch_related_lookups)
  File \""/usr/local/lib/python3.10/site-packages/django/db/models/query.py\"", line 1730, in prefetch_related_objects
    obj_list, additional_lookups = prefetch_one_level(
  File \""/usr/local/lib/python3.10/site-packages/django/db/models/query.py\"", line 1872, in prefetch_one_level
    all_related_objects = list(rel_qs)
  File \""/usr/local/lib/python3.10/site-packages/django/db/models/query.py\"", line 262, in __len__
    self._fetch_all()
  File \""/usr/local/lib/python3.10/site-packages/django/db/models/query.py\"", line 1324, in _fetch_all
    self._result_cache = list(self._iterable_class(self))
  File \""/usr/local/lib/python3.10/site-packages/django/db/models/query.py\"", line 51, in __iter__
    results = compiler.execute_sql(chunked_fetch=self.chunked_fetch, chunk_size=self.chunk_size)
  File \""/usr/local/lib/python3.10/site-packages/django/db/models/sql/compiler.py\"", line 1175, in execute_sql
    cursor.execute(sql, params)
  File \""/usr/local/lib/python3.10/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 112, in execute
    return self._trace_method(self.__wrapped__.execute, self._self_datadog_name, query, {}, query, *args, **kwargs)
  File \""/usr/local/lib/python3.10/site-packages/ddtrace/contrib/psycopg/patch.py\"", line 59, in _trace_method
    return super(Psycopg2TracedCursor, self)._trace_method(method, name, resource, extra_tags, *args, **kwargs)
  File \""/usr/local/lib/python3.10/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 75, in _trace_method
    return method(*args, **kwargs)
  File \""/usr/local/lib/python3.10/site-packages/sentry_sdk/integrations/django/__init__.py\"", line 500, in execute
    return real_execute(self, sql, params)
  File \""/usr/local/lib/python3.10/site-packages/django/db/backends/utils.py\"", line 66, in execute
    return self._execute_with_wrappers(sql, params, many=False, executor=self._execute)
  File \""/usr/local/lib/python3.10/site-packages/django/db/backends/utils.py\"", line 75, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File \""/usr/local/lib/python3.10/site-packages/django/db/backends/utils.py\"", line 79, in _execute
    with self.db.wrap_database_errors:
  File \""/usr/local/lib/python3.10/site-packages/django/db/utils.py\"", line 90, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File \""/usr/local/lib/python3.10/site-packages/django/db/backends/utils.py\"", line 84, in _execute
    return self.cursor.execute(sql, params)
  File \""/usr/local/lib/python3.10/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 112, in execute
    return self._trace_method(self.__wrapped__.execute, self._self_datadog_name, query, {}, query, *args, **kwargs)
  File \""/usr/local/lib/python3.10/site-packages/ddtrace/contrib/psycopg/patch.py\"", line 59, in _trace_method
    return super(Psycopg2TracedCursor, self)._trace_method(method, name, resource, extra_tags, *args, **kwargs)
  File \""/usr/local/lib/python3.10/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 75, in _trace_method
    return method(*args, **kwargs)
django.db.utils.OperationalError: terminating connection due to administrator command
SSL connection has been closed unexpectedly
"", ""status_code"": 500, ""request"": ""<WSGIRequest: GET '/api/v1/live-events/?ourns=urn:orm:live-event-series:0636920056459:live-event:0636920063054,urn:orm:live-event-series:0636920058477:live-event:0636920058790,urn:orm:live-event-series:0636920061597:live-event:0636920064620,urn:orm:live-event-series:0636920060223:live-event:0636920061364,urn:orm:live-event-series:0636920414971:live-event:0636920064273,urn:orm:live-event-series:0636920375982:live-event:0636920063437,urn:orm:live{""asctime"":""2021-12-02T16:31:15+0000"", ""message"":""[pid: 6|app: 0|req: 70/167] 10.134.0.208 () {64 vars in 5204 bytes} [Thu Dec  2 16:31:13 2021] GET /api/v1/live-events/?ourns=urn:orm:live-event-series:0636920056459:live-event:0636920063054,urn:orm:live-event-series:0636920058477:live-event:0636920058790,urn:orm:live-event-series:0636920061597:live-event:0636920064620,urn:orm:live-event-series:0636920060223:live-event:0636920061364,urn:orm:live-event-series:0636920414971:live-event:0636920064273,urn:orm:live-event-series:0636920375982:live-event:0636920063437,urn:orm:live-event-series:0636920345275:live-event:0636920066361,urn:orm:live-event-series:0636920359593:live-event:0636920064278,urn:orm:live-event-series:0636920064583:live-event:0636920064582,urn:orm:live-event-series:0636920357643:live-event:0636920063805,urn:orm:live-event-series:0636920055881:live-event:0636920064863,urn:orm:live-event-series:0636920057909:live-event:0636920064260&limit=12 => generated 145 bytes in 1680 msecs (HTTP/1.1 500) 7 headers in 226 bytes (1 switches on core 0)""}"
2021-12-02T16:29:24.115Z,gke-platform-prod-cluster-np-01-3fe7d044-vb34.c.platform-prod-399563.internal,live_event_metadata_service:http,"{""asctime"": ""2021-12-02T16:29:23.844"", ""module"": ""log"", ""levelname"": ""ERROR"", ""message"": ""Internal Server Error: /api/v1/live-events/"", ""exc_info"": ""Traceback (most recent call last):
  File \""/usr/local/lib/python3.10/site-packages/django/db/models/fields/related_descriptors.py\"", line 173, in __get__
    rel_obj = self.field.get_cached_value(instance)
  File \""/usr/local/lib/python3.10/site-packages/django/db/models/fields/mixins.py\"", line 15, in get_cached_value
    return instance._state.fields_cache[cache_name]
KeyError: 'series'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File \""/usr/local/lib/python3.10/site-packages/django/db/backends/utils.py\"", line 84, in _execute
    return self.cursor.execute(sql, params)
  File \""/usr/local/lib/python3.10/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 112, in execute
    return self._trace_method(self.__wrapped__.execute, self._self_datadog_name, query, {}, query, *args, **kwargs)
  File \""/usr/local/lib/python3.10/site-packages/ddtrace/contrib/psycopg/patch.py\"", line 59, in _trace_method
    return super(Psycopg2TracedCursor, self)._trace_method(method, name, resource, extra_tags, *args, **kwargs)
  File \""/usr/local/lib/python3.10/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 75, in _trace_method
    return method(*args, **kwargs)
psycopg2.errors.AdminShutdown: terminating connection due to administrator command
SSL connection has been closed unexpectedly


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File \""/usr/local/lib/python3.10/site-packages/django/core/handlers/exception.py\"", line 47, in inner
    response = get_response(request)
  File \""/usr/local/lib/python3.10/site-packages/django/core/handlers/base.py\"", line 181, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File \""/usr/local/lib/python3.10/site-packages/sentry_sdk/integrations/django/views.py\"", line 67, in sentry_wrapped_callback
    return callback(request, *args, **kwargs)
  File \""/usr/local/lib/python3.10/site-packages/ddtrace/contrib/trace_utils.py\"", line 162, in wrapper
    return func(mod, pin, wrapped, instance, args, kwargs)
  File \""/usr/local/lib/python3.10/site-packages/ddtrace/contrib/django/patch.py\"", line 213, in wrapped
    return func(*args, **kwargs)
  File \""/usr/local/lib/python3.10/site-packages/django/views/decorators/csrf.py\"", line 54, in wrapped_view
    return view_func(*args, **kwargs)
  File \""/usr/local/lib/python3.10/site-packages/rest_framework/viewsets.py\"", line 125, in view
    return self.dispatch(request, *args, **kwargs)
  File \""/usr/local/lib/python3.10/site-packages/ddtrace/contrib/trace_utils.py\"", line 162, in wrapper
    return func(mod, pin, wrapped, instance, args, kwargs)
  File \""/usr/local/lib/python3.10/site-packages/ddtrace/contrib/django/patch.py\"", line 213, in wrapped
    return func(*args, **kwargs)
  File \""/usr/local/lib/python3.10/site-packages/rest_framework/views.py\"", line 509, in dispatch
    response = self.handle_exception(exc)
  File \""/usr/local/lib/python3.10/site-packages/ddtrace/contrib/trace_utils.py\"", line 162, in wrapper
    return func(mod, pin, wrapped, instance, args, kwargs)
  File \""/usr/local/lib/python3.10/site-packages/ddtrace/contrib/django/restframework.py\"", line 19, in _traced_handle_exception
    return wrapped(*args, **kwargs)
  File \""/usr/local/lib/python3.10/site-packages/rest_framework/views.py\"", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File \""/usr/local/lib/python3.10/site-packages/rest_framework/views.py\"", line 480, in raise_uncaught_exception
    raise exc
  File \""/usr/local/lib/python3.10/site-packages/rest_framework/views.py\"", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File \""/usr/local/lib/python3.10/site-packages/rest_framework/mixins.py\"", line 43, in list
    return self.get_paginated_response(serializer.data)
  File \""/usr/local/lib/python3.10/site-packages/rest_framework/serializers.py\"", line 745, in data
    ret = super().data
  File \""/usr/local/lib/python3.10/site-packages/rest_framework/serializers.py\"", line 246, in data
    self._data = self.to_representation(self.instance)
  File \""/usr/local/lib/python3.10/site-packages/rest_framework/serializers.py\"", line 663, in to_representation
    return [
  File \""/usr/local/lib/python3.10/site-packages/rest_framework/serializers.py\"", line 664, in <listcomp>
    self.child.to_representation(item) for item in iterable
  File \""/usr/local/lib/python3.10/site-packages/rest_framework/serializers.py\"", line 502, in to_representation
    attribute = field.get_attribute(instance)
  File \""/usr/local/lib/python3.10/site-packages/rest_framework/fields.py\"", line 457, in get_attribute
    return get_attribute(instance, self.source_attrs)
  File \""/usr/local/lib/python3.10/site-packages/rest_framework/fields.py\"", line 97, in get_attribute
    instance = getattr(instance, attr)
  File \""/usr/local/lib/python3.10/site-packages/django/db/models/fields/related_descriptors.py\"", line 187, in __get__
    rel_obj = self.get_object(instance)
  File \""/usr/local/lib/python3.10/site-packages/django/db/models/fields/related_descriptors.py\"", line 154, in get_object
    return qs.get(self.field.get_reverse_related_filter(instance))
  File \""/usr/local/lib/python3.10/site-packages/django/db/models/query.py\"", line 431, in get
    num = len(clone)
  File \""/usr/local/lib/python3.10/site-packages/django/db/models/query.py\"", line 262, in __len__
    self._fetch_all()
  File \""/usr/local/lib/python3.10/site-packages/django/db/models/query.py\"", line 1324, in _fetch_all
    self._result_cache = list(self._iterable_class(self))
  File \""/usr/local/lib/python3.10/site-packages/django/db/models/query.py\"", line 51, in __iter__
    results = compiler.execute_sql(chunked_fetch=self.chunked_fetch, chunk_size=self.chunk_size)
  File \""/usr/local/lib/python3.10/site-packages/django/db/models/sql/compiler.py\"", line 1175, in execute_sql
    cursor.execute(sql, params)
  File \""/usr/local/lib/python3.10/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 112, in execute
    return self._trace_method(self.__wrapped__.execute, self._self_datadog_name, query, {}, query, *args, **kwargs)
  File \""/usr/local/lib/python3.10/site-packages/ddtrace/contrib/psycopg/patch.py\"", line 59, in _trace_method
    return super(Psycopg2TracedCursor, self)._trace_method(method, name, resource, extra_tags, *args, **kwargs)
  File \""/usr/local/lib/python3.10/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 75, in _trace_method
    return method(*args, **kwargs)
  File \""/usr/local/lib/python3.10/site-packages/sentry_sdk/integrations/django/__init__.py\"", line 500, in execute
    return real_execute(self, sql, params)
  File \""/usr/local/lib/python3.10/site-packages/django/db/backends/utils.py\"", line 66, in execute
    return self._execute_with_wrappers(sql, params, many=False, executor=self._execute)
  File \""/usr/local/lib/python3.10/site-packages/django/db/backends/utils.py\"", line 75, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File \""/usr/local/lib/python3.10/site-packages/django/db/backends/utils.py\"", line 79, in _execute
    with self.db.wrap_database_errors:
  File \""/usr/local/lib/python3.10/site-packages/django/db/utils.py\"", line 90, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File \""/usr/local/lib/python3.10/site-packages/django/db/backends/utils.py\"", line 84, in _execute
    return self.cursor.execute(sql, params)
  File \""/usr/local/lib/python3.10/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 112, in execute
    return self._trace_method(self.__wrapped__.execute, self._self_datadog_name, query, {}, query, *args, **kwargs)
  File \""/usr/local/lib/python3.10/site-packages/ddtrace/contrib/psycopg/patch.py\"", line 59, in _trace_method
    return super(Psycopg2TracedCursor, {""asctime"":""2021-12-02T16:29:23+0000"", ""message"":""[pid: 6|app: 0|req: 175/429] 10.134.0.174 () {66 vars in 8844 bytes} [Thu Dec  2 16:29:21 2021] GET /api/v1/live-events/?ourns=urn%3Aorm%3Alive-event-series%3A0636920240594%3Alive-event%3A0636920280354%2Curn%3Aorm%3Alive-event-series%3A0636920137849%3Alive-event%3A0636920287070%2Curn%3Aorm%3Alive-event-series%3A0636920289081%3Alive-event%3A0636920293088%2Curn%3Aorm%3Alive-event-series%3A0636920182917%3Alive-event%3A0636920265931%2Curn%3Aorm%3Alive-event-series%3A0636920253242%3Alive-event%3A0636920279822%2Curn%3Aorm%3Alive-event-series%3A0636920303268%3Alive-event%3A0636920303251%2Curn%3Aorm%3Alive-event-series%3A0636920296454%3Alive-event%3A0636920296447%2Curn%3Aorm%3Alive-event-series%3A0636920137849%3Alive-event%3A0636920308027%2Curn%3Aorm%3Alive-event-series%3A0636920071099%3Alive-event%3A0636920311829%2Curn%3Aorm%3Alive-event-series%3A0636920260523%3Alive-event%3A0636920301189%2Curn%3Aorm%3Alive-event-series%3A0636920261797%3Alive-event%3A0636920275978%2Curn%3Aorm%3Alive-event-series%3A0636920106050%3Alive-event%3A0636920307853%2Curn%3Aorm%3Alive-event-series%3A0636920284963%3Alive-event%3A0636920308546%2Curn%3Aorm%3Alive-event-series%3A0636920269793%3Alive-event%3A0636920298991%2Curn%3Aorm%3Alive-event-series%3A0636920174134%3Alive-event%3A0636920322924%2Curn%3Aorm%3Alive-event-series%3A0636920282488%3Alive-event%3A0636920311119%2Curn%3Aorm%3Alive-event-series%3A0636920261797%3Alive-event%3A0636920323587%2Curn%3Aorm%3Alive-event-series%3A0636920444978%3Alive-event%3A0636920444961%2Curn%3Aorm%3Alive-event-series%3A0636920443735%3Alive-event%3A0636920410027%2Curn%3Aorm%3Alive-event-series%3A0636920403173%3Alive-event%3A0636920403159%2Curn%3Aorm%3Alive-event-series%3A0636920357643%3Alive-event%3A0636920415060%2Curn%3Aorm%3Alive-event-series%3A0636920409175%3Alive-event%3A0636920414858%2Curn%3Aorm%3Alive-event-series%3A0636920099789%3Alive-event%3A0636920425151%2Curn%3Aorm%3Alive-event-series%3A0636920268215%3Alive-event%3A0636920421634%2Curn%3Aorm%3Alive-event-series%3A0636920337829%3Alive-event%3A0636920051681%2Curn%3Aorm%3Alive-event-series%3A0636920053226%3Alive-event%3A0636920053225%2Curn%3Aorm%3Alive-event-series%3A0636920054349%3Alive-event%3A0636920054348%2Curn%3Aorm%3Alive-event-series%3A0636920053260%3Alive-event%3A0636920053259%2Curn%3Aorm%3Alive-event-series%3A0636920053242%3Alive-event%3A0636920053241%2Curn%3Aorm%3Alive-event-series%3A0636920053215%3Alive-event%3A0636920053214%2Curn%3Aorm%3Alive-event-series%3A0636920053229%3Alive-event%3A0636920053228%2Curn%3Aorm%3Alive-event-series%3A0636920055929%3Alive-event%3A0636920055928%2Curn%3Aorm%3Alive-event-series%3A0636920278689%3Alive-event%3A0636920056833%2Curn%3Aorm%3Alive-event-series%3A0636920056259%3Alive-event%3A0636920056258%2Curn%3Aorm%3Alive-event-series%3A0636920372783%3Alive-event%3A0636920058716%2Curn%3Aorm%3Alive-event-series%3A0636920057761%3Alive-event%3A0636920057760%2Curn%3Aorm%3Alive-event-series%3A0636920508816%3Alive-event%3A0636920060717%2Curn%3Aorm%3Alive-event-series%3A0636920436867%3Alive-event%3A0636920064054%2Curn%3Aorm%3Alive-event-series%3A0636920215868%3Alive-event%3A0636920059435&limit=50&all_events=true&ordering=start_datetime => generated 145 bytes in 2591 msecs (HTTP/1.1 500) 7 headers in 226 bytes (1 switches on core 0)""}"
2021-12-02T15:14:50.330Z,gke-platform-prod-cluster-np-01-3fe7d044-g0ej.c.platform-prod-399563.internal,bowerbird:celery,"Task bowerbird.tasks.broadcast_collection_activity_message[47f6e576-6a87-4a71-8411-580760a614be] raised unexpected: OperationalError('terminating connection due to administrator command
SSL connection has been closed unexpectedly
')"
2021-12-02T15:11:43.421Z,gke-platform-prod-cluster-np-01-d54e11d6-vzii.c.platform-prod-399563.internal,bowerbird:celery-etag-generator-tasks,"Task bowerbird.tasks.generate_user_collection_list_etag[0b1a0a35-5259-459b-a0e9-8d43e6ba3e06] raised unexpected: OperationalError('terminating connection due to administrator command
SSL connection has been closed unexpectedly
')"
2021-12-02T15:11:43.413Z,gke-platform-prod-cluster-np-01-bffac76f-eiyh.c.platform-prod-399563.internal,bowerbird:celery-etag-generator-tasks,"Task bowerbird.tasks.generate_user_collection_list_etag[fcbdc62b-1078-45b3-b8f1-8ee932ea83f4] raised unexpected: OperationalError('terminating connection due to administrator command
SSL connection has been closed unexpectedly
')"
2021-12-02T15:11:43.383Z,gke-platform-prod-cluster-np-01-3fe7d044-g0vy.c.platform-prod-399563.internal,bowerbird:celery-etag-generator-tasks,"Task bowerbird.tasks.generate_user_collection_list_etag[04229d35-ea89-4ae7-bb4f-1a6d95516fed] raised unexpected: OperationalError('terminating connection due to administrator command
SSL connection has been closed unexpectedly
')"
2021-12-02T15:11:41.658Z,gke-platform-prod-cluster-np-01-3fe7d044-g0ej.c.platform-prod-399563.internal,bowerbird:celery,"Task bowerbird.tasks.update_user_display_name[9e45c8d3-4ef1-4640-8d0c-139601157f99] raised unexpected: OperationalError('terminating connection due to administrator command
SSL connection has been closed unexpectedly
')"
2021-12-02T15:11:39.788Z,gke-platform-prod-cluster-np-01-bffac76f-eiyh.c.platform-prod-399563.internal,bowerbird:celery-etag-generator-tasks,"Task bowerbird.tasks.generate_user_collection_list_etag[acc98271-8822-422a-921c-21bcb30bdc86] raised unexpected: OperationalError('terminating connection due to administrator command
SSL connection has been closed unexpectedly
')"
2021-12-02T15:11:39.696Z,gke-platform-prod-cluster-np-01-d54e11d6-vzii.c.platform-prod-399563.internal,bowerbird:celery-etag-generator-tasks,"Task bowerbird.tasks.generate_user_collection_list_etag[86f6ef24-6433-44ee-8783-7cf0244ed1bb] raised unexpected: OperationalError('terminating connection due to administrator command
SSL connection has been closed unexpectedly
')"
2021-12-02T15:11:39.151Z,gke-platform-prod-cluster-np-01-3fe7d044-g0ej.c.platform-prod-399563.internal,bowerbird:celery,"Task bowerbird.tasks.update_collection_from_account_change[779f7390-19ba-4119-b4ed-c5da80fa55c3] raised unexpected: OperationalError('terminating connection due to administrator command
SSL connection has been closed unexpectedly
')"
2021-12-02T15:11:38.710Z,gke-platform-prod-cluster-np-01-3fe7d044-g0vy.c.platform-prod-399563.internal,bowerbird:celery-etag-generator-tasks,"Task bowerbird.tasks.generate_user_collection_list_etag[7c164133-4265-4825-a607-c08094362a67] raised unexpected: OperationalError('terminating connection due to administrator command
SSL connection has been closed unexpectedly
')"
2021-12-02T15:11:35.306Z,gke-platform-prod-cluster-np-01-3fe7d044-g0ej.c.platform-prod-399563.internal,bowerbird:celery,"Task bowerbird.tasks.update_collection_last_viewed[e8fd170e-39c4-495e-a28d-eda2c2afd2be] raised unexpected: OperationalError('terminating connection due to administrator command
SSL connection has been closed unexpectedly
')"
2021-12-02T13:51:45.881Z,gke-platform-prod-clus-np-preemptible-c4954949-rkfw.c.platform-prod-399563.internal,warehouse_metabase:metabase,Caused by: org.postgresql.util.PSQLException: FATAL: terminating connection due to administrator command
2021-12-02T13:51:45.880Z,gke-platform-prod-clus-np-preemptible-c4954949-rkfw.c.platform-prod-399563.internal,warehouse_metabase:metabase,org.quartz.JobPersistenceException: Couldn't acquire next trigger: FATAL: terminating connection due to administrator command [See nested exception: org.postgresql.util.PSQLException: FATAL: terminating connection due to administrator command]
2021-12-02T13:51:45.880Z,gke-platform-prod-clus-np-preemptible-c4954949-rkfw.c.platform-prod-399563.internal,warehouse_metabase:metabase,Caused by: org.postgresql.util.PSQLException: FATAL: terminating connection due to administrator command
2021-12-02T13:51:45.880Z,gke-platform-prod-clus-np-preemptible-c4954949-rkfw.c.platform-prod-399563.internal,warehouse_metabase:metabase,org.quartz.JobPersistenceException: Failure identifying failed instances when checking-in: FATAL: terminating connection due to administrator command [See nested exception: org.postgresql.util.PSQLException: FATAL: terminating connection due to administrator command]
2021-12-02T13:51:45.880Z,gke-platform-prod-clus-np-preemptible-c4954949-rkfw.c.platform-prod-399563.internal,warehouse_metabase:metabase,"2021-12-02 13:51:44,926 ERROR jdbcjobstore.JobStoreTX :: ClusterManager: Error managing cluster: Failure identifying failed instances when checking-in: FATAL: terminating connection due to administrator command"
2021-12-02T13:42:12.829Z,gke-platform-prod-cluster-np-01-3fe7d044-ekh9.c.platform-prod-399563.internal,loon:http,"{""asctime"": ""2021-12-02T13:42:12.232"", ""module"": ""log"", ""levelname"": ""ERROR"", ""message"": ""Internal Server Error: /api/v1/ormusers/81b60b89-8cc9-44ba-8648-6fb99566e7fd/"", ""exc_info"": ""Traceback (most recent call last):
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/fields/related_descriptors.py\"", line 173, in __get__
    rel_obj = self.field.get_cached_value(instance)
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/fields/mixins.py\"", line 15, in get_cached_value
    return instance._state.fields_cache[cache_name]
KeyError: 'content'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 84, in _execute
    return self.cursor.execute(sql, params)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 110, in execute
    return self._trace_method(self.__wrapped__.execute, self._self_datadog_name, query, {}, query, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/psycopg/patch.py\"", line 59, in _trace_method
    return super(Psycopg2TracedCursor, self)._trace_method(method, name, resource, extra_tags, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 73, in _trace_method
    return method(*args, **kwargs)
psycopg2.errors.AdminShutdown: terminating connection due to administrator command
SSL connection has been closed unexpectedly


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File \""/usr/local/lib/python3.9/site-packages/django/core/handlers/exception.py\"", line 47, in inner
    response = get_response(request)
  File \""/usr/local/lib/python3.9/site-packages/django/core/handlers/base.py\"", line 181, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File \""/usr/local/lib/python3.9/site-packages/sentry_sdk/integrations/django/views.py\"", line 67, in sentry_wrapped_callback
    return callback(request, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/trace_utils.py\"", line 162, in wrapper
    return func(mod, pin, wrapped, instance, args, kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/django/patch.py\"", line 211, in wrapped
    return func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/django/views/decorators/csrf.py\"", line 54, in wrapped_view
    return view_func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/viewsets.py\"", line 125, in view
    return self.dispatch(request, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/django/utils/decorators.py\"", line 43, in _wrapper
    return bound_method(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/django/views/decorators/cache.py\"", line 44, in _wrapped_view_func
    response = view_func(request, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/views.py\"", line 509, in dispatch
    response = self.handle_exception(exc)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/trace_utils.py\"", line 162, in wrapper
    return func(mod, pin, wrapped, instance, args, kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/django/restframework.py\"", line 19, in _traced_handle_exception
    return wrapped(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/views.py\"", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/views.py\"", line 480, in raise_uncaught_exception
    raise exc
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/views.py\"", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/mixins.py\"", line 56, in retrieve
    return Response(serializer.data)
  File \""/orm/service/./api/serializers.py\"", line 34, in data
    ret = super(serializers.Serializer, self).data
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/serializers.py\"", line 246, in data
    self._data = self.to_representation(self.instance)
  File \""/orm/service/./api/serializers.py\"", line 101, in to_representation
    representation = ProgressSerializer(
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/serializers.py\"", line 548, in data
    ret = super().data
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/serializers.py\"", line 246, in data
    self._data = self.to_representation(self.instance)
  File \""/orm/service/./api/serializers.py\"", line 155, in to_representation
    representation = super(ProgressSerializer, self).to_representation(instance)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/serializers.py\"", line 502, in to_representation
    attribute = field.get_attribute(instance)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/fields.py\"", line 457, in get_attribute
    return get_attribute(instance, self.source_attrs)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/fields.py\"", line 97, in get_attribute
    instance = getattr(instance, attr)
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/fields/related_descriptors.py\"", line 187, in __get__
    rel_obj = self.get_object(instance)
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/fields/related_descriptors.py\"", line 154, in get_object
    return qs.get(self.field.get_reverse_related_filter(instance))
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/query.py\"", line 431, in get
    num = len(clone)
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/query.py\"", line 262, in __len__
    self._fetch_all()
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/query.py\"", line 1324, in _fetch_all
    self._result_cache = list(self._iterable_class(self))
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/query.py\"", line 51, in __iter__
    results = compiler.execute_sql(chunked_fetch=self.chunked_fetch, chunk_size=self.chunk_size)
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/sql/compiler.py\"", line 1175, in execute_sql
    cursor.execute(sql, params)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 110, in execute
    return self._trace_method(self.__wrapped__.execute, self._self_datadog_name, query, {}, query, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/psycopg/patch.py\"", line 59, in _trace_method
    return super(Psycopg2TracedCursor, self)._trace_method(method, name, resource, extra_tags, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 73, in _trace_method
    return method(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/sentry_sdk/integrations/django/__init__.py\"", line 500, in execute
    return real_execute(self, sql, params)
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 66, in execute
    return self._execute_with_wrappers(sql, params, many=False, executor=self._execute)
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 75, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 84, in _execute
    return self.cursor.execute(sql, params)
  File \""/usr/local/lib/python3.9/site-packages/django/db/utils.py\"", line 90, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 84, in _execute
    return self.cursor.execute(sql, params)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 110, in execute
    return self._trace_m{""asctime"":""2021-12-02T13:42:12+0000"", ""message"":""[pid: 168|app: 0|req: 6422763/9957160] 10.134.91.100 () {46 vars in 1773 bytes} [Thu Dec  2 13:42:11 2021] GET /api/v1/ormusers/81b60b89-8cc9-44ba-8648-6fb99566e7fd/?reference_id=9781492092384-/ch06.html => generated 145 bytes in 319 msecs (HTTP/1.1 500) 7 headers in 211 bytes (1 switches on core 0)""}"
2021-12-02T13:15:11.129Z,gke-platform-prod-cluster-np-01-3fe7d044-hcir.c.platform-prod-399563.internal,coot:http,"{""asctime"": ""2021-12-02T13:15:10.307"", ""module"": ""log"", ""levelname"": ""ERROR"", ""message"": ""Internal Server Error: /api/v2/usage-event/"", ""exc_info"": ""Traceback (most recent call last):
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 84, in _execute
    return self.cursor.execute(sql, params)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 110, in execute
    return self._trace_method(self.__wrapped__.execute, self._self_datadog_name, query, {}, query, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/psycopg/patch.py\"", line 59, in _trace_method
    return super(Psycopg2TracedCursor, self)._trace_method(method, name, resource, extra_tags, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 73, in _trace_method
    return method(*args, **kwargs)
psycopg2.errors.AdminShutdown: terminating connection due to administrator command
server closed the connection unexpectedly
\tThis probably means the server terminated abnormally
\tbefore or while processing the request.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File \""/usr/local/lib/python3.9/site-packages/django/core/handlers/exception.py\"", line 47, in inner
    response = get_response(request)
  File \""/usr/local/lib/python3.9/site-packages/django/core/handlers/base.py\"", line 181, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File \""/usr/local/lib/python3.9/site-packages/sentry_sdk/integrations/django/views.py\"", line 67, in sentry_wrapped_callback
    return callback(request, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/trace_utils.py\"", line 162, in wrapper
    return func(mod, pin, wrapped, instance, args, kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/django/patch.py\"", line 211, in wrapped
    return func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/django/views/decorators/csrf.py\"", line 54, in wrapped_view
    return view_func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/viewsets.py\"", line 125, in view
    return self.dispatch(request, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/trace_utils.py\"", line 162, in wrapper
    return func(mod, pin, wrapped, instance, args, kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/django/patch.py\"", line 211, in wrapped
    return func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/views.py\"", line 509, in dispatch
    response = self.handle_exception(exc)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/trace_utils.py\"", line 162, in wrapper
    return func(mod, pin, wrapped, instance, args, kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/django/restframework.py\"", line 19, in _traced_handle_exception
    return wrapped(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/views.py\"", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/views.py\"", line 480, in raise_uncaught_exception
    raise exc
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/views.py\"", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File \""/orm/service/./api/viewsets.py\"", line 70, in create
    self.perform_create(serializer)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/mixins.py\"", line 24, in perform_create
    serializer.save()
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/serializers.py\"", line 708, in save
    self.instance = self.create(validated_data)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/serializers.py\"", line 680, in create
    return [
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/serializers.py\"", line 681, in <listcomp>
    self.child.create(attrs) for attrs in validated_data
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/serializers.py\"", line 939, in create
    instance = ModelClass._default_manager.create(**validated_data)
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/manager.py\"", line 85, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/query.py\"", line 453, in create
    obj.save(force_insert=True, using=self.db)
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/base.py\"", line 726, in save
    self.save_base(using=using, force_insert=force_insert,
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/base.py\"", line 763, in save_base
    updated = self._save_table(
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/base.py\"", line 868, in _save_table
    results = self._do_insert(cls._base_manager, using, fields, returning_fields, raw)
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/base.py\"", line 906, in _do_insert
    return manager._insert(
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/manager.py\"", line 85, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/query.py\"", line 1270, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/sql/compiler.py\"", line 1416, in execute_sql
    cursor.execute(sql, params)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 110, in execute
    return self._trace_method(self.__wrapped__.execute, self._self_datadog_name, query, {}, query, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/psycopg/patch.py\"", line 59, in _trace_method
    return super(Psycopg2TracedCursor, self)._trace_method(method, name, resource, extra_tags, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 73, in _trace_method
    return method(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/sentry_sdk/integrations/django/__init__.py\"", line 500, in execute
    return real_execute(self, sql, params)
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 66, in execute
    return self._execute_with_wrappers(sql, params, many=False, executor=self._execute)
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 75, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 84, in _execute
    return self.cursor.execute(sql, params)
  File \""/usr/local/lib/python3.9/site-packages/django/db/utils.py\"", line 90, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 84, in _execute
    return self.cursor.execute(sql, params)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 110, in execute
    return self._trace_method(self.__wrapped__.execute, self._self_datadog_name, query, {}, query, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/psycopg/patch.py\"", line 59, in _trace_method
    return super(Psycopg2TracedCursor, self)._trace_method(method, name, resource, extra_tags, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 73, in _trace_method
    return method(*args, **kwargs)
django.db.utils.OperationalError: terminating connection due to administrator command
server closed the connection unexpectedly
\tThis probably means the server terminated abnormally
\tbefore or while processing the request.
"", ""{""asctime"":""2021-12-02T13:15:10+0000"", ""message"":""[pid: 8|app: 0|req: 13507998/24379818] 122.161.49.188 () {104 vars in 6535 bytes} [Thu Dec  2 13:15:10 2021] POST /api/v2/usage-event/ => generated 145 bytes in 264 msecs (HTTP/1.1 500) 9 headers in 396 bytes (1 switches on core 0)""}"
2021-12-02T13:15:11.129Z,gke-platform-prod-cluster-np-01-3fe7d044-hcir.c.platform-prod-399563.internal,coot:http,"{""asctime"": ""2021-12-02T13:15:10.247"", ""module"": ""log"", ""levelname"": ""ERROR"", ""message"": ""Internal Server Error: /api/v2/usage-event/"", ""exc_info"": ""Traceback (most recent call last):
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 84, in _execute
    return self.cursor.execute(sql, params)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 110, in execute
    return self._trace_method(self.__wrapped__.execute, self._self_datadog_name, query, {}, query, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/psycopg/patch.py\"", line 59, in _trace_method
    return super(Psycopg2TracedCursor, self)._trace_method(method, name, resource, extra_tags, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 73, in _trace_method
    return method(*args, **kwargs)
psycopg2.errors.AdminShutdown: terminating connection due to administrator command
server closed the connection unexpectedly
\tThis probably means the server terminated abnormally
\tbefore or while processing the request.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File \""/usr/local/lib/python3.9/site-packages/django/core/handlers/exception.py\"", line 47, in inner
    response = get_response(request)
  File \""/usr/local/lib/python3.9/site-packages/django/core/handlers/base.py\"", line 181, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File \""/usr/local/lib/python3.9/site-packages/sentry_sdk/integrations/django/views.py\"", line 67, in sentry_wrapped_callback
    return callback(request, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/trace_utils.py\"", line 162, in wrapper
    return func(mod, pin, wrapped, instance, args, kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/django/patch.py\"", line 211, in wrapped
    return func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/django/views/decorators/csrf.py\"", line 54, in wrapped_view
    return view_func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/viewsets.py\"", line 125, in view
    return self.dispatch(request, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/trace_utils.py\"", line 162, in wrapper
    return func(mod, pin, wrapped, instance, args, kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/django/patch.py\"", line 211, in wrapped
    return func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/views.py\"", line 509, in dispatch
    response = self.handle_exception(exc)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/trace_utils.py\"", line 162, in wrapper
    return func(mod, pin, wrapped, instance, args, kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/django/restframework.py\"", line 19, in _traced_handle_exception
    return wrapped(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/views.py\"", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/views.py\"", line 480, in raise_uncaught_exception
    raise exc
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/views.py\"", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File \""/orm/service/./api/viewsets.py\"", line 70, in create
    self.perform_create(serializer)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/mixins.py\"", line 24, in perform_create
    serializer.save()
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/serializers.py\"", line 708, in save
    self.instance = self.create(validated_data)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/serializers.py\"", line 680, in create
    return [
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/serializers.py\"", line 681, in <listcomp>
    self.child.create(attrs) for attrs in validated_data
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/serializers.py\"", line 939, in create
    instance = ModelClass._default_manager.create(**validated_data)
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/manager.py\"", line 85, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/query.py\"", line 453, in create
    obj.save(force_insert=True, using=self.db)
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/base.py\"", line 726, in save
    self.save_base(using=using, force_insert=force_insert,
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/base.py\"", line 763, in save_base
    updated = self._save_table(
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/base.py\"", line 868, in _save_table
    results = self._do_insert(cls._base_manager, using, fields, returning_fields, raw)
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/base.py\"", line 906, in _do_insert
    return manager._insert(
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/manager.py\"", line 85, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/query.py\"", line 1270, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/sql/compiler.py\"", line 1416, in execute_sql
    cursor.execute(sql, params)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 110, in execute
    return self._trace_method(self.__wrapped__.execute, self._self_datadog_name, query, {}, query, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/psycopg/patch.py\"", line 59, in _trace_method
    return super(Psycopg2TracedCursor, self)._trace_method(method, name, resource, extra_tags, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 73, in _trace_method
    return method(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/sentry_sdk/integrations/django/__init__.py\"", line 500, in execute
    return real_execute(self, sql, params)
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 66, in execute
    return self._execute_with_wrappers(sql, params, many=False, executor=self._execute)
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 75, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 84, in _execute
    return self.cursor.execute(sql, params)
  File \""/usr/local/lib/python3.9/site-packages/django/db/utils.py\"", line 90, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 84, in _execute
    return self.cursor.execute(sql, params)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 110, in execute
    return self._trace_method(self.__wrapped__.execute, self._self_datadog_name, query, {}, query, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/psycopg/patch.py\"", line 59, in _trace_method
    return super(Psycopg2TracedCursor, self)._trace_method(method, name, resource, extra_tags, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 73, in _trace_method
    return method(*args, **kwargs)
django.db.utils.OperationalError: terminating connection due to administrator command
server closed the connection unexpectedly
\tThis probably means the server terminated abnormally
\tbefore or while processing the request.
"", ""{""asctime"":""2021-12-02T13:15:10+0000"", ""message"":""[pid: 6|app: 0|req: 10871784/24379817] 103.195.203.20 () {108 vars in 6144 bytes} [Thu Dec  2 13:15:10 2021] POST /api/v2/usage-event/ => generated 145 bytes in 202 msecs (HTTP/1.1 500) 9 headers in 396 bytes (1 switches on core 0)""}"
2021-12-02T13:15:10.654Z,gke-platform-prod-cluster-np-01-bffac76f-aif6.c.platform-prod-399563.internal,coot:http,"{""asctime"": ""2021-12-02T13:15:10.286"", ""module"": ""log"", ""levelname"": ""ERROR"", ""message"": ""Internal Server Error: /api/v2/usage-event/"", ""exc_info"": ""Traceback (most recent call last):
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 84, in _execute
    return self.cursor.execute(sql, params)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 110, in execute
    return self._trace_method(self.__wrapped__.execute, self._self_datadog_name, query, {}, query, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/psycopg/patch.py\"", line 59, in _trace_method
    return super(Psycopg2TracedCursor, self)._trace_method(method, name, resource, extra_tags, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 73, in _trace_method
    return method(*args, **kwargs)
psycopg2.errors.AdminShutdown: terminating connection due to administrator command
server closed the connection unexpectedly
\tThis probably means the server terminated abnormally
\tbefore or while processing the request.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File \""/usr/local/lib/python3.9/site-packages/django/core/handlers/exception.py\"", line 47, in inner
    response = get_response(request)
  File \""/usr/local/lib/python3.9/site-packages/django/core/handlers/base.py\"", line 181, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File \""/usr/local/lib/python3.9/site-packages/sentry_sdk/integrations/django/views.py\"", line 67, in sentry_wrapped_callback
    return callback(request, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/trace_utils.py\"", line 162, in wrapper
    return func(mod, pin, wrapped, instance, args, kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/django/patch.py\"", line 211, in wrapped
    return func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/django/views/decorators/csrf.py\"", line 54, in wrapped_view
    return view_func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/viewsets.py\"", line 125, in view
    return self.dispatch(request, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/trace_utils.py\"", line 162, in wrapper
    return func(mod, pin, wrapped, instance, args, kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/django/patch.py\"", line 211, in wrapped
    return func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/views.py\"", line 509, in dispatch
    response = self.handle_exception(exc)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/trace_utils.py\"", line 162, in wrapper
    return func(mod, pin, wrapped, instance, args, kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/django/restframework.py\"", line 19, in _traced_handle_exception
    return wrapped(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/views.py\"", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/views.py\"", line 480, in raise_uncaught_exception
    raise exc
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/views.py\"", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File \""/orm/service/./api/viewsets.py\"", line 70, in create
    self.perform_create(serializer)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/mixins.py\"", line 24, in perform_create
    serializer.save()
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/serializers.py\"", line 708, in save
    self.instance = self.create(validated_data)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/serializers.py\"", line 680, in create
    return [
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/serializers.py\"", line 681, in <listcomp>
    self.child.create(attrs) for attrs in validated_data
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/serializers.py\"", line 939, in create
    instance = ModelClass._default_manager.create(**validated_data)
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/manager.py\"", line 85, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/query.py\"", line 453, in create
    obj.save(force_insert=True, using=self.db)
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/base.py\"", line 726, in save
    self.save_base(using=using, force_insert=force_insert,
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/base.py\"", line 763, in save_base
    updated = self._save_table(
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/base.py\"", line 868, in _save_table
    results = self._do_insert(cls._base_manager, using, fields, returning_fields, raw)
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/base.py\"", line 906, in _do_insert
    return manager._insert(
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/manager.py\"", line 85, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/query.py\"", line 1270, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/sql/compiler.py\"", line 1416, in execute_sql
    cursor.execute(sql, params)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 110, in execute
    return self._trace_method(self.__wrapped__.execute, self._self_datadog_name, query, {}, query, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/psycopg/patch.py\"", line 59, in _trace_method
    return super(Psycopg2TracedCursor, self)._trace_method(method, name, resource, extra_tags, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 73, in _trace_method
    return method(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/sentry_sdk/integrations/django/__init__.py\"", line 500, in execute
    return real_execute(self, sql, params)
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 66, in execute
    return self._execute_with_wrappers(sql, params, many=False, executor=self._execute)
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 75, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 84, in _execute
    return self.cursor.execute(sql, params)
  File \""/usr/local/lib/python3.9/site-packages/django/db/utils.py\"", line 90, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 84, in _execute
    return self.cursor.execute(sql, params)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 110, in execute
    return self._trace_method(self.__wrapped__.execute, self._self_datadog_name, query, {}, query, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/psycopg/patch.py\"", line 59, in _trace_method
    return super(Psycopg2TracedCursor, self)._trace_method(method, name, resource, extra_tags, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 73, in _trace_method
    return method(*args, **kwargs)
django.db.utils.OperationalError: terminating connection due to administrator command
server closed the connection unexpectedly
\tThis probably means the server terminated abnormally
\tbefore or while processing the request.
"", ""{""asctime"":""2021-12-02T13:15:10+0000"", ""message"":""[pid: 8|app: 0|req: 135736/248378] 75.111.85.208 () {108 vars in 6275 bytes} [Thu Dec  2 13:15:10 2021] POST /api/v2/usage-event/ => generated 145 bytes in 183 msecs (HTTP/1.1 500) 9 headers in 396 bytes (1 switches on core 0)""}"
2021-12-02T13:15:10.653Z,gke-platform-prod-cluster-np-01-bffac76f-aif6.c.platform-prod-399563.internal,coot:http,"{""asctime"": ""2021-12-02T13:15:10.258"", ""module"": ""log"", ""levelname"": ""ERROR"", ""message"": ""Internal Server Error: /api/v2/usage-event/"", ""exc_info"": ""Traceback (most recent call last):
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 84, in _execute
    return self.cursor.execute(sql, params)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 110, in execute
    return self._trace_method(self.__wrapped__.execute, self._self_datadog_name, query, {}, query, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/psycopg/patch.py\"", line 59, in _trace_method
    return super(Psycopg2TracedCursor, self)._trace_method(method, name, resource, extra_tags, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 73, in _trace_method
    return method(*args, **kwargs)
psycopg2.errors.AdminShutdown: terminating connection due to administrator command
server closed the connection unexpectedly
\tThis probably means the server terminated abnormally
\tbefore or while processing the request.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File \""/usr/local/lib/python3.9/site-packages/django/core/handlers/exception.py\"", line 47, in inner
    response = get_response(request)
  File \""/usr/local/lib/python3.9/site-packages/django/core/handlers/base.py\"", line 181, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File \""/usr/local/lib/python3.9/site-packages/sentry_sdk/integrations/django/views.py\"", line 67, in sentry_wrapped_callback
    return callback(request, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/trace_utils.py\"", line 162, in wrapper
    return func(mod, pin, wrapped, instance, args, kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/django/patch.py\"", line 211, in wrapped
    return func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/django/views/decorators/csrf.py\"", line 54, in wrapped_view
    return view_func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/viewsets.py\"", line 125, in view
    return self.dispatch(request, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/trace_utils.py\"", line 162, in wrapper
    return func(mod, pin, wrapped, instance, args, kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/django/patch.py\"", line 211, in wrapped
    return func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/views.py\"", line 509, in dispatch
    response = self.handle_exception(exc)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/trace_utils.py\"", line 162, in wrapper
    return func(mod, pin, wrapped, instance, args, kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/django/restframework.py\"", line 19, in _traced_handle_exception
    return wrapped(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/views.py\"", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/views.py\"", line 480, in raise_uncaught_exception
    raise exc
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/views.py\"", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File \""/orm/service/./api/viewsets.py\"", line 70, in create
    self.perform_create(serializer)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/mixins.py\"", line 24, in perform_create
    serializer.save()
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/serializers.py\"", line 708, in save
    self.instance = self.create(validated_data)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/serializers.py\"", line 680, in create
    return [
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/serializers.py\"", line 681, in <listcomp>
    self.child.create(attrs) for attrs in validated_data
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/serializers.py\"", line 939, in create
    instance = ModelClass._default_manager.create(**validated_data)
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/manager.py\"", line 85, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/query.py\"", line 453, in create
    obj.save(force_insert=True, using=self.db)
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/base.py\"", line 726, in save
    self.save_base(using=using, force_insert=force_insert,
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/base.py\"", line 763, in save_base
    updated = self._save_table(
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/base.py\"", line 868, in _save_table
    results = self._do_insert(cls._base_manager, using, fields, returning_fields, raw)
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/base.py\"", line 906, in _do_insert
    return manager._insert(
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/manager.py\"", line 85, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/query.py\"", line 1270, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/sql/compiler.py\"", line 1416, in execute_sql
    cursor.execute(sql, params)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 110, in execute
    return self._trace_method(self.__wrapped__.execute, self._self_datadog_name, query, {}, query, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/psycopg/patch.py\"", line 59, in _trace_method
    return super(Psycopg2TracedCursor, self)._trace_method(method, name, resource, extra_tags, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 73, in _trace_method
    return method(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/sentry_sdk/integrations/django/__init__.py\"", line 500, in execute
    return real_execute(self, sql, params)
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 66, in execute
    return self._execute_with_wrappers(sql, params, many=False, executor=self._execute)
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 75, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 84, in _execute
    return self.cursor.execute(sql, params)
  File \""/usr/local/lib/python3.9/site-packages/django/db/utils.py\"", line 90, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 84, in _execute
    return self.cursor.execute(sql, params)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 110, in execute
    return self._trace_method(self.__wrapped__.execute, self._self_datadog_name, query, {}, query, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/psycopg/patch.py\"", line 59, in _trace_method
    return super(Psycopg2TracedCursor, self)._trace_method(method, name, resource, extra_tags, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 73, in _trace_method
    return method(*args, **kwargs)
django.db.utils.OperationalError: terminating connection due to administrator command
server closed the connection unexpectedly
\tThis probably means the server terminated abnormally
\tbefore or while processing the request.
"", ""{""asctime"":""2021-12-02T13:15:10+0000"", ""message"":""[pid: 6|app: 0|req: 112642/248377] 73.146.105.7 () {92 vars in 4175 bytes} [Thu Dec  2 13:15:10 2021] POST /api/v2/usage-event/ => generated 145 bytes in 143 msecs (HTTP/1.1 500) 6 headers in 184 bytes (1 switches on core 0)""}"
2021-12-02T13:15:10.509Z,gke-platform-prod-cluster-np-01-d54e11d6-e2am.c.platform-prod-399563.internal,coot:http,"{""asctime"": ""2021-12-02T13:15:10.386"", ""module"": ""log"", ""levelname"": ""ERROR"", ""message"": ""Internal Server Error: /api/v2/usage-event/"", ""exc_info"": ""Traceback (most recent call last):
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 84, in _execute
    return self.cursor.execute(sql, params)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 110, in execute
    return self._trace_method(self.__wrapped__.execute, self._self_datadog_name, query, {}, query, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/psycopg/patch.py\"", line 59, in _trace_method
    return super(Psycopg2TracedCursor, self)._trace_method(method, name, resource, extra_tags, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 73, in _trace_method
    return method(*args, **kwargs)
psycopg2.errors.AdminShutdown: terminating connection due to administrator command
server closed the connection unexpectedly
\tThis probably means the server terminated abnormally
\tbefore or while processing the request.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File \""/orm/service/./usage/calculators/heron.py\"", line 42, in epub_chapter_calculator
    content, content_created = usage.models.Content.objects.get_or_create(
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/manager.py\"", line 85, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/query.py\"", line 581, in get_or_create
    return self.get(**kwargs), False
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/query.py\"", line 431, in get
    num = len(clone)
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/query.py\"", line 262, in __len__
    self._fetch_all()
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/query.py\"", line 1324, in _fetch_all
    self._result_cache = list(self._iterable_class(self))
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/query.py\"", line 51, in __iter__
    results = compiler.execute_sql(chunked_fetch=self.chunked_fetch, chunk_size=self.chunk_size)
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/sql/compiler.py\"", line 1175, in execute_sql
    cursor.execute(sql, params)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 110, in execute
    return self._trace_method(self.__wrapped__.execute, self._self_datadog_name, query, {}, query, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/psycopg/patch.py\"", line 59, in _trace_method
    return super(Psycopg2TracedCursor, self)._trace_method(method, name, resource, extra_tags, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 73, in _trace_method
    return method(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/sentry_sdk/integrations/django/__init__.py\"", line 500, in execute
    return real_execute(self, sql, params)
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 66, in execute
    return self._execute_with_wrappers(sql, params, many=False, executor=self._execute)
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 75, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 84, in _execute
    return self.cursor.execute(sql, params)
  File \""/usr/local/lib/python3.9/site-packages/django/db/utils.py\"", line 90, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 84, in _execute
    return self.cursor.execute(sql, params)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 110, in execute
    return self._trace_method(self.__wrapped__.execute, self._self_datadog_name, query, {}, query, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/psycopg/patch.py\"", line 59, in _trace_method
    return super(Psycopg2TracedCursor, self)._trace_method(method, name, resource, extra_tags, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 73, in _trace_method
    return method(*args, **kwargs)
django.db.utils.OperationalError: terminating connection due to administrator command
server closed the connection unexpectedly
\tThis probably means the server terminated abnormally
\tbefore or while processing the request.


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/base/base.py\"", line 219, in ensure_connection
    self.connect()
  File \""/usr/local/lib/python3.9/site-packages/django/utils/asyncio.py\"", line 26, in inner
    return func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/base/base.py\"", line 200, in connect
    self.connection = self.get_new_connection(conn_params)
  File \""/usr/local/lib/python3.9/site-packages/django/utils/asyncio.py\"", line 26, in inner
    return func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/postgresql/base.py\"", line 187, in get_new_connection
    connection = Database.connect(**conn_params)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/psycopg/patch.py\"", line 122, in patched_connect
    conn = connect_func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py\"", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
psycopg2.OperationalError: FATAL:  the database system is shutting down
FATAL:  the database system is shutting down


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File \""/usr/local/lib/python3.9/site-packages/django/core/handlers/exception.py\"", line 47, in inner
    response = get_response(request)
  File \""/usr/local/lib/python3.9/site-packages/django/core/handlers/base.py\"", line 181, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File \""/usr/local/lib/python3.9/site-packages/sentry_sdk/integrations/django/views.py\"", line 67, in sentry_wrapped_callback
    return callback(request, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/trace_utils.py\"", line 162, in wrapper
    return func(mod, pin, wrapped, instance, args, kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/django/patch.py\"", line 211, in wrapped
    return func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/django/views/decorators/csrf.py\"", line 54, in wrapped_view
    return view_func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/viewsets.py\"", line 125, in view
    return self.dispatch(request, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/trace_utils.py\"", line 162, in wrapper
    return func(mod, pin, wrapped, instance, args, kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/django/patch.py\"", line 211, in wrapped
    return func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/views.py\"", line 509, in dispatch
    response = self.handle_exception(exc)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/trace_utils.py\"", line 162, in wrapper
    return func(mod, pin, wrapped, instance, args, kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/django/restframework.py\"", line 19, in _traced_handle_exception
    return wrapped(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/r{""asctime"":""2021-12-02T13:15:10+0000"", ""message"":""[pid: 8|app: 0|req: 3642760/6645272] 24.216.15.62 () {110 vars in 5072 bytes} [Thu Dec  2 13:15:10 2021] POST /api/v2/usage-event/ => generated 145 bytes in 133 msecs (HTTP/1.1 500) 9 headers in 396 bytes (1 switches on core 0)""}"
2021-12-02T13:15:10.509Z,gke-platform-prod-cluster-np-01-d54e11d6-e2am.c.platform-prod-399563.internal,coot:http,"{""asctime"": ""2021-12-02T13:15:10.288"", ""module"": ""log"", ""levelname"": ""ERROR"", ""message"": ""Internal Server Error: /api/v2/usage-event/"", ""exc_info"": ""Traceback (most recent call last):
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 84, in _execute
    return self.cursor.execute(sql, params)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 110, in execute
    return self._trace_method(self.__wrapped__.execute, self._self_datadog_name, query, {}, query, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/psycopg/patch.py\"", line 59, in _trace_method
    return super(Psycopg2TracedCursor, self)._trace_method(method, name, resource, extra_tags, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 73, in _trace_method
    return method(*args, **kwargs)
psycopg2.errors.AdminShutdown: terminating connection due to administrator command
server closed the connection unexpectedly
\tThis probably means the server terminated abnormally
\tbefore or while processing the request.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File \""/orm/service/./usage/calculators/heron.py\"", line 42, in epub_chapter_calculator
    content, content_created = usage.models.Content.objects.get_or_create(
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/manager.py\"", line 85, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/query.py\"", line 581, in get_or_create
    return self.get(**kwargs), False
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/query.py\"", line 431, in get
    num = len(clone)
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/query.py\"", line 262, in __len__
    self._fetch_all()
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/query.py\"", line 1324, in _fetch_all
    self._result_cache = list(self._iterable_class(self))
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/query.py\"", line 51, in __iter__
    results = compiler.execute_sql(chunked_fetch=self.chunked_fetch, chunk_size=self.chunk_size)
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/sql/compiler.py\"", line 1175, in execute_sql
    cursor.execute(sql, params)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 110, in execute
    return self._trace_method(self.__wrapped__.execute, self._self_datadog_name, query, {}, query, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/psycopg/patch.py\"", line 59, in _trace_method
    return super(Psycopg2TracedCursor, self)._trace_method(method, name, resource, extra_tags, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 73, in _trace_method
    return method(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/sentry_sdk/integrations/django/__init__.py\"", line 500, in execute
    return real_execute(self, sql, params)
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 66, in execute
    return self._execute_with_wrappers(sql, params, many=False, executor=self._execute)
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 75, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 84, in _execute
    return self.cursor.execute(sql, params)
  File \""/usr/local/lib/python3.9/site-packages/django/db/utils.py\"", line 90, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 84, in _execute
    return self.cursor.execute(sql, params)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 110, in execute
    return self._trace_method(self.__wrapped__.execute, self._self_datadog_name, query, {}, query, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/psycopg/patch.py\"", line 59, in _trace_method
    return super(Psycopg2TracedCursor, self)._trace_method(method, name, resource, extra_tags, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 73, in _trace_method
    return method(*args, **kwargs)
django.db.utils.OperationalError: terminating connection due to administrator command
server closed the connection unexpectedly
\tThis probably means the server terminated abnormally
\tbefore or while processing the request.


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/base/base.py\"", line 219, in ensure_connection
    self.connect()
  File \""/usr/local/lib/python3.9/site-packages/django/utils/asyncio.py\"", line 26, in inner
    return func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/base/base.py\"", line 200, in connect
    self.connection = self.get_new_connection(conn_params)
  File \""/usr/local/lib/python3.9/site-packages/django/utils/asyncio.py\"", line 26, in inner
    return func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/postgresql/base.py\"", line 187, in get_new_connection
    connection = Database.connect(**conn_params)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/psycopg/patch.py\"", line 122, in patched_connect
    conn = connect_func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py\"", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
psycopg2.OperationalError: FATAL:  the database system is shutting down
FATAL:  the database system is shutting down


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File \""/usr/local/lib/python3.9/site-packages/django/core/handlers/exception.py\"", line 47, in inner
    response = get_response(request)
  File \""/usr/local/lib/python3.9/site-packages/django/core/handlers/base.py\"", line 181, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File \""/usr/local/lib/python3.9/site-packages/sentry_sdk/integrations/django/views.py\"", line 67, in sentry_wrapped_callback
    return callback(request, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/trace_utils.py\"", line 162, in wrapper
    return func(mod, pin, wrapped, instance, args, kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/django/patch.py\"", line 211, in wrapped
    return func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/django/views/decorators/csrf.py\"", line 54, in wrapped_view
    return view_func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/viewsets.py\"", line 125, in view
    return self.dispatch(request, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/trace_utils.py\"", line 162, in wrapper
    return func(mod, pin, wrapped, instance, args, kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/django/patch.py\"", line 211, in wrapped
    return func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/views.py\"", line 509, in dispatch
    response = self.handle_exception(exc)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/trace_utils.py\"", line 162, in wrapper
    return func(mod, pin, wrapped, instance, args, kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/django/restframework.py\"", line 19, in _traced_handle_exception
    return wrapped(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/r{""asctime"":""2021-12-02T13:15:10+0000"", ""message"":""[pid: 6|app: 0|req: 3002465/6645269] 155.190.34.7 () {108 vars in 6367 bytes} [Thu Dec  2 13:15:10 2021] POST /api/v2/usage-event/ => generated 145 bytes in 90 msecs (HTTP/1.1 500) 9 headers in 396 bytes (1 switches on core 0)""}"
2021-12-02T13:15:10.396Z,gke-platform-prod-cluster-np-01-3fe7d044-vb34.c.platform-prod-399563.internal,coot:http,"{""asctime"": ""2021-12-02T13:15:10.358"", ""module"": ""log"", ""levelname"": ""ERROR"", ""message"": ""Internal Server Error: /api/v2/usage-event/"", ""exc_info"": ""Traceback (most recent call last):
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 84, in _execute
    return self.cursor.execute(sql, params)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 110, in execute
    return self._trace_method(self.__wrapped__.execute, self._self_datadog_name, query, {}, query, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/psycopg/patch.py\"", line 59, in _trace_method
    return super(Psycopg2TracedCursor, self)._trace_method(method, name, resource, extra_tags, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 73, in _trace_method
    return method(*args, **kwargs)
psycopg2.errors.AdminShutdown: terminating connection due to administrator command
server closed the connection unexpectedly
\tThis probably means the server terminated abnormally
\tbefore or while processing the request.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File \""/orm/service/./usage/calculators/heron.py\"", line 42, in epub_chapter_calculator
    content, content_created = usage.models.Content.objects.get_or_create(
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/manager.py\"", line 85, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/query.py\"", line 581, in get_or_create
    return self.get(**kwargs), False
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/query.py\"", line 431, in get
    num = len(clone)
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/query.py\"", line 262, in __len__
    self._fetch_all()
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/query.py\"", line 1324, in _fetch_all
    self._result_cache = list(self._iterable_class(self))
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/query.py\"", line 51, in __iter__
    results = compiler.execute_sql(chunked_fetch=self.chunked_fetch, chunk_size=self.chunk_size)
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/sql/compiler.py\"", line 1175, in execute_sql
    cursor.execute(sql, params)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 110, in execute
    return self._trace_method(self.__wrapped__.execute, self._self_datadog_name, query, {}, query, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/psycopg/patch.py\"", line 59, in _trace_method
    return super(Psycopg2TracedCursor, self)._trace_method(method, name, resource, extra_tags, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 73, in _trace_method
    return method(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/sentry_sdk/integrations/django/__init__.py\"", line 500, in execute
    return real_execute(self, sql, params)
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 66, in execute
    return self._execute_with_wrappers(sql, params, many=False, executor=self._execute)
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 75, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 84, in _execute
    return self.cursor.execute(sql, params)
  File \""/usr/local/lib/python3.9/site-packages/django/db/utils.py\"", line 90, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 84, in _execute
    return self.cursor.execute(sql, params)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 110, in execute
    return self._trace_method(self.__wrapped__.execute, self._self_datadog_name, query, {}, query, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/psycopg/patch.py\"", line 59, in _trace_method
    return super(Psycopg2TracedCursor, self)._trace_method(method, name, resource, extra_tags, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 73, in _trace_method
    return method(*args, **kwargs)
django.db.utils.OperationalError: terminating connection due to administrator command
server closed the connection unexpectedly
\tThis probably means the server terminated abnormally
\tbefore or while processing the request.


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/base/base.py\"", line 219, in ensure_connection
    self.connect()
  File \""/usr/local/lib/python3.9/site-packages/django/utils/asyncio.py\"", line 26, in inner
    return func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/base/base.py\"", line 200, in connect
    self.connection = self.get_new_connection(conn_params)
  File \""/usr/local/lib/python3.9/site-packages/django/utils/asyncio.py\"", line 26, in inner
    return func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/postgresql/base.py\"", line 187, in get_new_connection
    connection = Database.connect(**conn_params)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/psycopg/patch.py\"", line 122, in patched_connect
    conn = connect_func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py\"", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
psycopg2.OperationalError: FATAL:  the database system is shutting down
FATAL:  the database system is shutting down


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File \""/usr/local/lib/python3.9/site-packages/django/core/handlers/exception.py\"", line 47, in inner
    response = get_response(request)
  File \""/usr/local/lib/python3.9/site-packages/django/core/handlers/base.py\"", line 181, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File \""/usr/local/lib/python3.9/site-packages/sentry_sdk/integrations/django/views.py\"", line 67, in sentry_wrapped_callback
    return callback(request, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/trace_utils.py\"", line 162, in wrapper
    return func(mod, pin, wrapped, instance, args, kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/django/patch.py\"", line 211, in wrapped
    return func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/django/views/decorators/csrf.py\"", line 54, in wrapped_view
    return view_func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/viewsets.py\"", line 125, in view
    return self.dispatch(request, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/trace_utils.py\"", line 162, in wrapper
    return func(mod, pin, wrapped, instance, args, kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/django/patch.py\"", line 211, in wrapped
    return func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/views.py\"", line 509, in dispatch
    response = self.handle_exception(exc)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/trace_utils.py\"", line 162, in wrapper
    return func(mod, pin, wrapped, instance, args, kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/django/restframework.py\"", line 19, in _traced_handle_exception
    return wrapped(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/r{""asctime"":""2021-12-02T13:15:10+0000"", ""message"":""[pid: 6|app: 0|req: 10899143/24711654] 103.121.17.63 () {110 vars in 6043 bytes} [Thu Dec  2 13:15:10 2021] POST /api/v2/usage-event/ => generated 145 bytes in 204 msecs (HTTP/1.1 500) 9 headers in 396 bytes (1 switches on core 0)""}"
2021-12-02T13:15:10.396Z,gke-platform-prod-cluster-np-01-3fe7d044-vb34.c.platform-prod-399563.internal,coot:http,"{""asctime"": ""2021-12-02T13:15:10.263"", ""module"": ""log"", ""levelname"": ""ERROR"", ""message"": ""Internal Server Error: /api/v2/usage-event/"", ""exc_info"": ""Traceback (most recent call last):
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 84, in _execute
    return self.cursor.execute(sql, params)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 110, in execute
    return self._trace_method(self.__wrapped__.execute, self._self_datadog_name, query, {}, query, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/psycopg/patch.py\"", line 59, in _trace_method
    return super(Psycopg2TracedCursor, self)._trace_method(method, name, resource, extra_tags, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 73, in _trace_method
    return method(*args, **kwargs)
psycopg2.errors.AdminShutdown: terminating connection due to administrator command
server closed the connection unexpectedly
\tThis probably means the server terminated abnormally
\tbefore or while processing the request.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File \""/usr/local/lib/python3.9/site-packages/django/core/handlers/exception.py\"", line 47, in inner
    response = get_response(request)
  File \""/usr/local/lib/python3.9/site-packages/django/core/handlers/base.py\"", line 181, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File \""/usr/local/lib/python3.9/site-packages/sentry_sdk/integrations/django/views.py\"", line 67, in sentry_wrapped_callback
    return callback(request, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/trace_utils.py\"", line 162, in wrapper
    return func(mod, pin, wrapped, instance, args, kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/django/patch.py\"", line 211, in wrapped
    return func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/django/views/decorators/csrf.py\"", line 54, in wrapped_view
    return view_func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/viewsets.py\"", line 125, in view
    return self.dispatch(request, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/trace_utils.py\"", line 162, in wrapper
    return func(mod, pin, wrapped, instance, args, kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/django/patch.py\"", line 211, in wrapped
    return func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/views.py\"", line 509, in dispatch
    response = self.handle_exception(exc)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/trace_utils.py\"", line 162, in wrapper
    return func(mod, pin, wrapped, instance, args, kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/django/restframework.py\"", line 19, in _traced_handle_exception
    return wrapped(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/views.py\"", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/views.py\"", line 480, in raise_uncaught_exception
    raise exc
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/views.py\"", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File \""/orm/service/./api/viewsets.py\"", line 70, in create
    self.perform_create(serializer)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/mixins.py\"", line 24, in perform_create
    serializer.save()
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/serializers.py\"", line 708, in save
    self.instance = self.create(validated_data)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/serializers.py\"", line 680, in create
    return [
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/serializers.py\"", line 681, in <listcomp>
    self.child.create(attrs) for attrs in validated_data
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/serializers.py\"", line 939, in create
    instance = ModelClass._default_manager.create(**validated_data)
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/manager.py\"", line 85, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/query.py\"", line 453, in create
    obj.save(force_insert=True, using=self.db)
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/base.py\"", line 726, in save
    self.save_base(using=using, force_insert=force_insert,
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/base.py\"", line 763, in save_base
    updated = self._save_table(
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/base.py\"", line 868, in _save_table
    results = self._do_insert(cls._base_manager, using, fields, returning_fields, raw)
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/base.py\"", line 906, in _do_insert
    return manager._insert(
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/manager.py\"", line 85, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/query.py\"", line 1270, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/sql/compiler.py\"", line 1416, in execute_sql
    cursor.execute(sql, params)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 110, in execute
    return self._trace_method(self.__wrapped__.execute, self._self_datadog_name, query, {}, query, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/psycopg/patch.py\"", line 59, in _trace_method
    return super(Psycopg2TracedCursor, self)._trace_method(method, name, resource, extra_tags, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 73, in _trace_method
    return method(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/sentry_sdk/integrations/django/__init__.py\"", line 500, in execute
    return real_execute(self, sql, params)
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 66, in execute
    return self._execute_with_wrappers(sql, params, many=False, executor=self._execute)
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 75, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 84, in _execute
    return self.cursor.execute(sql, params)
  File \""/usr/local/lib/python3.9/site-packages/django/db/utils.py\"", line 90, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 84, in _execute
    return self.cursor.execute(sql, params)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 110, in execute
    return self._trace_method(self.__wrapped__.execute, self._self_datadog_name, query, {}, query, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/psycopg/patch.py\"", line 59, in _trace_method
    return super(Psycopg2TracedCursor, self)._trace_method(method, name, resource, extra_tags, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 73, in _trace_method
    return method(*args, **kwargs)
django.db.utils.OperationalError: terminating connection due to administrator command
server closed the connection unexpectedly
\tThis probably means the server terminated abnormally
\tbefore or while processing the request.
"", ""{""asctime"":""2021-12-02T13:15:10+0000"", ""message"":""[pid: 8|app: 0|req: 13812473/24711653] 73.193.135.90 () {110 vars in 6206 bytes} [Thu Dec  2 13:15:10 2021] POST /api/v2/usage-event/ => generated 145 bytes in 225 msecs (HTTP/1.1 500) 9 headers in 396 bytes (1 switches on core 0)""}"
2021-12-02T13:14:58.517Z,gke-platform-prod-cluster-np-01-3fe7d044-hcir.c.platform-prod-399563.internal,coot:http,"{""asctime"": ""2021-12-02T13:14:57.769"", ""module"": ""log"", ""levelname"": ""ERROR"", ""message"": ""Internal Server Error: /api/v2/usage-event/"", ""exc_info"": ""Traceback (most recent call last):
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 84, in _execute
    return self.cursor.execute(sql, params)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 110, in execute
    return self._trace_method(self.__wrapped__.execute, self._self_datadog_name, query, {}, query, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/psycopg/patch.py\"", line 59, in _trace_method
    return super(Psycopg2TracedCursor, self)._trace_method(method, name, resource, extra_tags, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 73, in _trace_method
    return method(*args, **kwargs)
psycopg2.errors.AdminShutdown: terminating connection due to administrator command
SSL connection has been closed unexpectedly


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File \""/orm/service/./usage/calculators/heron.py\"", line 42, in epub_chapter_calculator
    content, content_created = usage.models.Content.objects.get_or_create(
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/manager.py\"", line 85, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/query.py\"", line 581, in get_or_create
    return self.get(**kwargs), False
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/query.py\"", line 431, in get
    num = len(clone)
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/query.py\"", line 262, in __len__
    self._fetch_all()
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/query.py\"", line 1324, in _fetch_all
    self._result_cache = list(self._iterable_class(self))
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/query.py\"", line 51, in __iter__
    results = compiler.execute_sql(chunked_fetch=self.chunked_fetch, chunk_size=self.chunk_size)
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/sql/compiler.py\"", line 1175, in execute_sql
    cursor.execute(sql, params)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 110, in execute
    return self._trace_method(self.__wrapped__.execute, self._self_datadog_name, query, {}, query, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/psycopg/patch.py\"", line 59, in _trace_method
    return super(Psycopg2TracedCursor, self)._trace_method(method, name, resource, extra_tags, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 73, in _trace_method
    return method(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/sentry_sdk/integrations/django/__init__.py\"", line 500, in execute
    return real_execute(self, sql, params)
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 66, in execute
    return self._execute_with_wrappers(sql, params, many=False, executor=self._execute)
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 75, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 84, in _execute
    return self.cursor.execute(sql, params)
  File \""/usr/local/lib/python3.9/site-packages/django/db/utils.py\"", line 90, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 84, in _execute
    return self.cursor.execute(sql, params)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 110, in execute
    return self._trace_method(self.__wrapped__.execute, self._self_datadog_name, query, {}, query, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/psycopg/patch.py\"", line 59, in _trace_method
    return super(Psycopg2TracedCursor, self)._trace_method(method, name, resource, extra_tags, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 73, in _trace_method
    return method(*args, **kwargs)
django.db.utils.OperationalError: terminating connection due to administrator command
SSL connection has been closed unexpectedly


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/base/base.py\"", line 219, in ensure_connection
    self.connect()
  File \""/usr/local/lib/python3.9/site-packages/django/utils/asyncio.py\"", line 26, in inner
    return func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/base/base.py\"", line 200, in connect
    self.connection = self.get_new_connection(conn_params)
  File \""/usr/local/lib/python3.9/site-packages/django/utils/asyncio.py\"", line 26, in inner
    return func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/postgresql/base.py\"", line 187, in get_new_connection
    connection = Database.connect(**conn_params)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/psycopg/patch.py\"", line 122, in patched_connect
    conn = connect_func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py\"", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
psycopg2.OperationalError: FATAL:  the database system is shutting down
FATAL:  the database system is shutting down


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File \""/usr/local/lib/python3.9/site-packages/django/core/handlers/exception.py\"", line 47, in inner
    response = get_response(request)
  File \""/usr/local/lib/python3.9/site-packages/django/core/handlers/base.py\"", line 181, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File \""/usr/local/lib/python3.9/site-packages/sentry_sdk/integrations/django/views.py\"", line 67, in sentry_wrapped_callback
    return callback(request, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/trace_utils.py\"", line 162, in wrapper
    return func(mod, pin, wrapped, instance, args, kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/django/patch.py\"", line 211, in wrapped
    return func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/django/views/decorators/csrf.py\"", line 54, in wrapped_view
    return view_func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/viewsets.py\"", line 125, in view
    return self.dispatch(request, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/trace_utils.py\"", line 162, in wrapper
    return func(mod, pin, wrapped, instance, args, kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/django/patch.py\"", line 211, in wrapped
    return func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/views.py\"", line 509, in dispatch
    response = self.handle_exception(exc)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/trace_utils.py\"", line 162, in wrapper
    return func(mod, pin, wrapped, instance, args, kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/django/restframework.py\"", line 19, in _traced_handle_exception
    return wrapped(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/views.py\"", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/views.py\"", line 480, in raise_unc{""asctime"":""2021-12-02T13:14:57+0000"", ""message"":""[pid: 6|app: 0|req: 10871678/24379603] 172.58.157.146 () {108 vars in 5818 bytes} [Thu Dec  2 13:14:57 2021] POST /api/v2/usage-event/ => generated 145 bytes in 64 msecs (HTTP/1.1 500) 9 headers in 396 bytes (1 switches on core 0)""}"
2021-12-02T13:14:58.350Z,gke-platform-prod-cluster-np-01-3fe7d044-vb34.c.platform-prod-399563.internal,coot:http,"{""asctime"": ""2021-12-02T13:14:57.541"", ""module"": ""log"", ""levelname"": ""ERROR"", ""message"": ""Internal Server Error: /api/v2/usage-event/"", ""exc_info"": ""Traceback (most recent call last):
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 84, in _execute
    return self.cursor.execute(sql, params)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 110, in execute
    return self._trace_method(self.__wrapped__.execute, self._self_datadog_name, query, {}, query, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/psycopg/patch.py\"", line 59, in _trace_method
    return super(Psycopg2TracedCursor, self)._trace_method(method, name, resource, extra_tags, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 73, in _trace_method
    return method(*args, **kwargs)
psycopg2.errors.AdminShutdown: terminating connection due to administrator command
SSL connection has been closed unexpectedly


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File \""/orm/service/./usage/calculators/heron.py\"", line 42, in epub_chapter_calculator
    content, content_created = usage.models.Content.objects.get_or_create(
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/manager.py\"", line 85, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/query.py\"", line 581, in get_or_create
    return self.get(**kwargs), False
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/query.py\"", line 431, in get
    num = len(clone)
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/query.py\"", line 262, in __len__
    self._fetch_all()
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/query.py\"", line 1324, in _fetch_all
    self._result_cache = list(self._iterable_class(self))
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/query.py\"", line 51, in __iter__
    results = compiler.execute_sql(chunked_fetch=self.chunked_fetch, chunk_size=self.chunk_size)
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/sql/compiler.py\"", line 1175, in execute_sql
    cursor.execute(sql, params)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 110, in execute
    return self._trace_method(self.__wrapped__.execute, self._self_datadog_name, query, {}, query, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/psycopg/patch.py\"", line 59, in _trace_method
    return super(Psycopg2TracedCursor, self)._trace_method(method, name, resource, extra_tags, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 73, in _trace_method
    return method(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/sentry_sdk/integrations/django/__init__.py\"", line 500, in execute
    return real_execute(self, sql, params)
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 66, in execute
    return self._execute_with_wrappers(sql, params, many=False, executor=self._execute)
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 75, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 84, in _execute
    return self.cursor.execute(sql, params)
  File \""/usr/local/lib/python3.9/site-packages/django/db/utils.py\"", line 90, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 84, in _execute
    return self.cursor.execute(sql, params)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 110, in execute
    return self._trace_method(self.__wrapped__.execute, self._self_datadog_name, query, {}, query, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/psycopg/patch.py\"", line 59, in _trace_method
    return super(Psycopg2TracedCursor, self)._trace_method(method, name, resource, extra_tags, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 73, in _trace_method
    return method(*args, **kwargs)
django.db.utils.OperationalError: terminating connection due to administrator command
SSL connection has been closed unexpectedly


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/base/base.py\"", line 219, in ensure_connection
    self.connect()
  File \""/usr/local/lib/python3.9/site-packages/django/utils/asyncio.py\"", line 26, in inner
    return func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/base/base.py\"", line 200, in connect
    self.connection = self.get_new_connection(conn_params)
  File \""/usr/local/lib/python3.9/site-packages/django/utils/asyncio.py\"", line 26, in inner
    return func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/postgresql/base.py\"", line 187, in get_new_connection
    connection = Database.connect(**conn_params)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/psycopg/patch.py\"", line 122, in patched_connect
    conn = connect_func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py\"", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
psycopg2.OperationalError: FATAL:  the database system is shutting down
FATAL:  the database system is shutting down


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File \""/usr/local/lib/python3.9/site-packages/django/core/handlers/exception.py\"", line 47, in inner
    response = get_response(request)
  File \""/usr/local/lib/python3.9/site-packages/django/core/handlers/base.py\"", line 181, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File \""/usr/local/lib/python3.9/site-packages/sentry_sdk/integrations/django/views.py\"", line 67, in sentry_wrapped_callback
    return callback(request, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/trace_utils.py\"", line 162, in wrapper
    return func(mod, pin, wrapped, instance, args, kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/django/patch.py\"", line 211, in wrapped
    return func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/django/views/decorators/csrf.py\"", line 54, in wrapped_view
    return view_func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/viewsets.py\"", line 125, in view
    return self.dispatch(request, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/trace_utils.py\"", line 162, in wrapper
    return func(mod, pin, wrapped, instance, args, kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/django/patch.py\"", line 211, in wrapped
    return func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/views.py\"", line 509, in dispatch
    response = self.handle_exception(exc)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/trace_utils.py\"", line 162, in wrapper
    return func(mod, pin, wrapped, instance, args, kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/django/restframework.py\"", line 19, in _traced_handle_exception
    return wrapped(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/views.py\"", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/views.py\"", line 480, in raise_unc{""asctime"":""2021-12-02T13:14:57+0000"", ""message"":""[pid: 6|app: 0|req: 10899039/24711423] 86.44.146.96 () {106 vars in 5700 bytes} [Thu Dec  2 13:14:57 2021] POST /api/v2/usage-event/ => generated 145 bytes in 381 msecs (HTTP/1.1 500) 9 headers in 396 bytes (1 switches on core 0)""}"
2021-12-02T13:14:58.350Z,gke-platform-prod-cluster-np-01-3fe7d044-vb34.c.platform-prod-399563.internal,coot:http,"{""asctime"": ""2021-12-02T13:14:57.373"", ""module"": ""log"", ""levelname"": ""ERROR"", ""message"": ""Internal Server Error: /api/v2/usage-event/"", ""exc_info"": ""Traceback (most recent call last):
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 84, in _execute
    return self.cursor.execute(sql, params)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 110, in execute
    return self._trace_method(self.__wrapped__.execute, self._self_datadog_name, query, {}, query, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/psycopg/patch.py\"", line 59, in _trace_method
    return super(Psycopg2TracedCursor, self)._trace_method(method, name, resource, extra_tags, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 73, in _trace_method
    return method(*args, **kwargs)
psycopg2.errors.AdminShutdown: terminating connection due to administrator command
SSL connection has been closed unexpectedly


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File \""/usr/local/lib/python3.9/site-packages/django/core/handlers/exception.py\"", line 47, in inner
    response = get_response(request)
  File \""/usr/local/lib/python3.9/site-packages/django/core/handlers/base.py\"", line 181, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File \""/usr/local/lib/python3.9/site-packages/sentry_sdk/integrations/django/views.py\"", line 67, in sentry_wrapped_callback
    return callback(request, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/trace_utils.py\"", line 162, in wrapper
    return func(mod, pin, wrapped, instance, args, kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/django/patch.py\"", line 211, in wrapped
    return func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/django/views/decorators/csrf.py\"", line 54, in wrapped_view
    return view_func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/viewsets.py\"", line 125, in view
    return self.dispatch(request, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/trace_utils.py\"", line 162, in wrapper
    return func(mod, pin, wrapped, instance, args, kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/django/patch.py\"", line 211, in wrapped
    return func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/views.py\"", line 509, in dispatch
    response = self.handle_exception(exc)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/trace_utils.py\"", line 162, in wrapper
    return func(mod, pin, wrapped, instance, args, kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/django/restframework.py\"", line 19, in _traced_handle_exception
    return wrapped(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/views.py\"", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/views.py\"", line 480, in raise_uncaught_exception
    raise exc
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/views.py\"", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File \""/orm/service/./api/viewsets.py\"", line 70, in create
    self.perform_create(serializer)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/mixins.py\"", line 24, in perform_create
    serializer.save()
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/serializers.py\"", line 708, in save
    self.instance = self.create(validated_data)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/serializers.py\"", line 680, in create
    return [
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/serializers.py\"", line 681, in <listcomp>
    self.child.create(attrs) for attrs in validated_data
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/serializers.py\"", line 939, in create
    instance = ModelClass._default_manager.create(**validated_data)
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/manager.py\"", line 85, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/query.py\"", line 453, in create
    obj.save(force_insert=True, using=self.db)
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/base.py\"", line 726, in save
    self.save_base(using=using, force_insert=force_insert,
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/base.py\"", line 763, in save_base
    updated = self._save_table(
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/base.py\"", line 868, in _save_table
    results = self._do_insert(cls._base_manager, using, fields, returning_fields, raw)
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/base.py\"", line 906, in _do_insert
    return manager._insert(
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/manager.py\"", line 85, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/query.py\"", line 1270, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/sql/compiler.py\"", line 1416, in execute_sql
    cursor.execute(sql, params)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 110, in execute
    return self._trace_method(self.__wrapped__.execute, self._self_datadog_name, query, {}, query, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/psycopg/patch.py\"", line 59, in _trace_method
    return super(Psycopg2TracedCursor, self)._trace_method(method, name, resource, extra_tags, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 73, in _trace_method
    return method(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/sentry_sdk/integrations/django/__init__.py\"", line 500, in execute
    return real_execute(self, sql, params)
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 66, in execute
    return self._execute_with_wrappers(sql, params, many=False, executor=self._execute)
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 75, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 84, in _execute
    return self.cursor.execute(sql, params)
  File \""/usr/local/lib/python3.9/site-packages/django/db/utils.py\"", line 90, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 84, in _execute
    return self.cursor.execute(sql, params)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 110, in execute
    return self._trace_method(self.__wrapped__.execute, self._self_datadog_name, query, {}, query, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/psycopg/patch.py\"", line 59, in _trace_method
    return super(Psycopg2TracedCursor, self)._trace_method(method, name, resource, extra_tags, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 73, in _trace_method
    return method(*args, **kwargs)
django.db.utils.OperationalError: terminating connection due to administrator command
SSL connection has been closed unexpectedly
"", ""status_code"": 500, ""request"": ""<WSGIRequest: POST '/api/v2/usage-event/'>"", ""dd.version"": ""main-202110211704-18-7a339974"", ""dd.env"": ""prod-gke"", ""dd.service"": ""coot:http"", ""dd.trace_id"": ""409365{""asctime"":""2021-12-02T13:14:57+0000"", ""message"":""[pid: 8|app: 0|req: 13812345/24711421] 1.186.123.91 () {92 vars in 4286 bytes} [Thu Dec  2 13:14:57 2021] POST /api/v2/usage-event/ => generated 145 bytes in 301 msecs (HTTP/1.1 500) 6 headers in 184 bytes (1 switches on core 0)""}"
2021-12-02T13:14:58.198Z,gke-platform-prod-cluster-np-01-d54e11d6-e2am.c.platform-prod-399563.internal,coot:http,"{""asctime"": ""2021-12-02T13:14:57.404"", ""module"": ""log"", ""levelname"": ""ERROR"", ""message"": ""Internal Server Error: /api/v2/usage-event/"", ""exc_info"": ""Traceback (most recent call last):
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 84, in _execute
    return self.cursor.execute(sql, params)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 110, in execute
    return self._trace_method(self.__wrapped__.execute, self._self_datadog_name, query, {}, query, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/psycopg/patch.py\"", line 59, in _trace_method
    return super(Psycopg2TracedCursor, self)._trace_method(method, name, resource, extra_tags, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 73, in _trace_method
    return method(*args, **kwargs)
psycopg2.errors.AdminShutdown: terminating connection due to administrator command
SSL connection has been closed unexpectedly


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File \""/orm/service/./usage/calculators/heron.py\"", line 42, in epub_chapter_calculator
    content, content_created = usage.models.Content.objects.get_or_create(
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/manager.py\"", line 85, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/query.py\"", line 581, in get_or_create
    return self.get(**kwargs), False
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/query.py\"", line 431, in get
    num = len(clone)
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/query.py\"", line 262, in __len__
    self._fetch_all()
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/query.py\"", line 1324, in _fetch_all
    self._result_cache = list(self._iterable_class(self))
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/query.py\"", line 51, in __iter__
    results = compiler.execute_sql(chunked_fetch=self.chunked_fetch, chunk_size=self.chunk_size)
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/sql/compiler.py\"", line 1175, in execute_sql
    cursor.execute(sql, params)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 110, in execute
    return self._trace_method(self.__wrapped__.execute, self._self_datadog_name, query, {}, query, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/psycopg/patch.py\"", line 59, in _trace_method
    return super(Psycopg2TracedCursor, self)._trace_method(method, name, resource, extra_tags, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 73, in _trace_method
    return method(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/sentry_sdk/integrations/django/__init__.py\"", line 500, in execute
    return real_execute(self, sql, params)
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 66, in execute
    return self._execute_with_wrappers(sql, params, many=False, executor=self._execute)
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 75, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 84, in _execute
    return self.cursor.execute(sql, params)
  File \""/usr/local/lib/python3.9/site-packages/django/db/utils.py\"", line 90, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 84, in _execute
    return self.cursor.execute(sql, params)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 110, in execute
    return self._trace_method(self.__wrapped__.execute, self._self_datadog_name, query, {}, query, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/psycopg/patch.py\"", line 59, in _trace_method
    return super(Psycopg2TracedCursor, self)._trace_method(method, name, resource, extra_tags, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 73, in _trace_method
    return method(*args, **kwargs)
django.db.utils.OperationalError: terminating connection due to administrator command
SSL connection has been closed unexpectedly


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/base/base.py\"", line 219, in ensure_connection
    self.connect()
  File \""/usr/local/lib/python3.9/site-packages/django/utils/asyncio.py\"", line 26, in inner
    return func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/base/base.py\"", line 200, in connect
    self.connection = self.get_new_connection(conn_params)
  File \""/usr/local/lib/python3.9/site-packages/django/utils/asyncio.py\"", line 26, in inner
    return func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/postgresql/base.py\"", line 187, in get_new_connection
    connection = Database.connect(**conn_params)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/psycopg/patch.py\"", line 122, in patched_connect
    conn = connect_func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py\"", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
psycopg2.OperationalError: FATAL:  the database system is shutting down
FATAL:  the database system is shutting down


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File \""/usr/local/lib/python3.9/site-packages/django/core/handlers/exception.py\"", line 47, in inner
    response = get_response(request)
  File \""/usr/local/lib/python3.9/site-packages/django/core/handlers/base.py\"", line 181, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File \""/usr/local/lib/python3.9/site-packages/sentry_sdk/integrations/django/views.py\"", line 67, in sentry_wrapped_callback
    return callback(request, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/trace_utils.py\"", line 162, in wrapper
    return func(mod, pin, wrapped, instance, args, kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/django/patch.py\"", line 211, in wrapped
    return func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/django/views/decorators/csrf.py\"", line 54, in wrapped_view
    return view_func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/viewsets.py\"", line 125, in view
    return self.dispatch(request, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/trace_utils.py\"", line 162, in wrapper
    return func(mod, pin, wrapped, instance, args, kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/django/patch.py\"", line 211, in wrapped
    return func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/views.py\"", line 509, in dispatch
    response = self.handle_exception(exc)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/trace_utils.py\"", line 162, in wrapper
    return func(mod, pin, wrapped, instance, args, kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/django/restframework.py\"", line 19, in _traced_handle_exception
    return wrapped(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/views.py\"", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/views.py\"", line 480, in raise_unc{""asctime"":""2021-12-02T13:14:57+0000"", ""message"":""[pid: 6|app: 0|req: 3002342/6645038] 45.32.149.25 () {108 vars in 5045 bytes} [Thu Dec  2 13:14:57 2021] POST /api/v2/usage-event/ => generated 145 bytes in 307 msecs (HTTP/1.1 500) 9 headers in 396 bytes (1 switches on core 0)""}"
2021-12-02T13:14:58.198Z,gke-platform-prod-cluster-np-01-d54e11d6-e2am.c.platform-prod-399563.internal,coot:http,"{""asctime"": ""2021-12-02T13:14:57.393"", ""module"": ""log"", ""levelname"": ""ERROR"", ""message"": ""Internal Server Error: /api/v2/usage-event/"", ""exc_info"": ""Traceback (most recent call last):
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 84, in _execute
    return self.cursor.execute(sql, params)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 110, in execute
    return self._trace_method(self.__wrapped__.execute, self._self_datadog_name, query, {}, query, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/psycopg/patch.py\"", line 59, in _trace_method
    return super(Psycopg2TracedCursor, self)._trace_method(method, name, resource, extra_tags, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 73, in _trace_method
    return method(*args, **kwargs)
psycopg2.errors.AdminShutdown: terminating connection due to administrator command
SSL connection has been closed unexpectedly


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File \""/orm/service/./usage/calculators/heron.py\"", line 42, in epub_chapter_calculator
    content, content_created = usage.models.Content.objects.get_or_create(
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/manager.py\"", line 85, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/query.py\"", line 581, in get_or_create
    return self.get(**kwargs), False
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/query.py\"", line 431, in get
    num = len(clone)
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/query.py\"", line 262, in __len__
    self._fetch_all()
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/query.py\"", line 1324, in _fetch_all
    self._result_cache = list(self._iterable_class(self))
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/query.py\"", line 51, in __iter__
    results = compiler.execute_sql(chunked_fetch=self.chunked_fetch, chunk_size=self.chunk_size)
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/sql/compiler.py\"", line 1175, in execute_sql
    cursor.execute(sql, params)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 110, in execute
    return self._trace_method(self.__wrapped__.execute, self._self_datadog_name, query, {}, query, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/psycopg/patch.py\"", line 59, in _trace_method
    return super(Psycopg2TracedCursor, self)._trace_method(method, name, resource, extra_tags, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 73, in _trace_method
    return method(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/sentry_sdk/integrations/django/__init__.py\"", line 500, in execute
    return real_execute(self, sql, params)
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 66, in execute
    return self._execute_with_wrappers(sql, params, many=False, executor=self._execute)
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 75, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 84, in _execute
    return self.cursor.execute(sql, params)
  File \""/usr/local/lib/python3.9/site-packages/django/db/utils.py\"", line 90, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 84, in _execute
    return self.cursor.execute(sql, params)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 110, in execute
    return self._trace_method(self.__wrapped__.execute, self._self_datadog_name, query, {}, query, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/psycopg/patch.py\"", line 59, in _trace_method
    return super(Psycopg2TracedCursor, self)._trace_method(method, name, resource, extra_tags, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 73, in _trace_method
    return method(*args, **kwargs)
django.db.utils.OperationalError: terminating connection due to administrator command
SSL connection has been closed unexpectedly


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/base/base.py\"", line 219, in ensure_connection
    self.connect()
  File \""/usr/local/lib/python3.9/site-packages/django/utils/asyncio.py\"", line 26, in inner
    return func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/base/base.py\"", line 200, in connect
    self.connection = self.get_new_connection(conn_params)
  File \""/usr/local/lib/python3.9/site-packages/django/utils/asyncio.py\"", line 26, in inner
    return func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/postgresql/base.py\"", line 187, in get_new_connection
    connection = Database.connect(**conn_params)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/psycopg/patch.py\"", line 122, in patched_connect
    conn = connect_func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py\"", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
psycopg2.OperationalError: FATAL:  the database system is shutting down
FATAL:  the database system is shutting down


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File \""/usr/local/lib/python3.9/site-packages/django/core/handlers/exception.py\"", line 47, in inner
    response = get_response(request)
  File \""/usr/local/lib/python3.9/site-packages/django/core/handlers/base.py\"", line 181, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File \""/usr/local/lib/python3.9/site-packages/sentry_sdk/integrations/django/views.py\"", line 67, in sentry_wrapped_callback
    return callback(request, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/trace_utils.py\"", line 162, in wrapper
    return func(mod, pin, wrapped, instance, args, kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/django/patch.py\"", line 211, in wrapped
    return func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/django/views/decorators/csrf.py\"", line 54, in wrapped_view
    return view_func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/viewsets.py\"", line 125, in view
    return self.dispatch(request, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/trace_utils.py\"", line 162, in wrapper
    return func(mod, pin, wrapped, instance, args, kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/django/patch.py\"", line 211, in wrapped
    return func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/views.py\"", line 509, in dispatch
    response = self.handle_exception(exc)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/trace_utils.py\"", line 162, in wrapper
    return func(mod, pin, wrapped, instance, args, kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/django/restframework.py\"", line 19, in _traced_handle_exception
    return wrapped(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/views.py\"", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/views.py\"", line 480, in raise_unc{""asctime"":""2021-12-02T13:14:57+0000"", ""message"":""[pid: 8|app: 0|req: 3642650/6645036] 157.45.98.171 () {102 vars in 6536 bytes} [Thu Dec  2 13:14:57 2021] POST /api/v2/usage-event/ => generated 145 bytes in 292 msecs (HTTP/1.1 500) 9 headers in 396 bytes (1 switches on core 0)""}"
2021-12-02T13:14:57.628Z,gke-platform-prod-cluster-np-01-bffac76f-aif6.c.platform-prod-399563.internal,coot:http,"{""asctime"": ""2021-12-02T13:14:57.402"", ""module"": ""log"", ""levelname"": ""ERROR"", ""message"": ""Internal Server Error: /api/v2/usage-event/"", ""exc_info"": ""Traceback (most recent call last):
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 84, in _execute
    return self.cursor.execute(sql, params)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 110, in execute
    return self._trace_method(self.__wrapped__.execute, self._self_datadog_name, query, {}, query, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/psycopg/patch.py\"", line 59, in _trace_method
    return super(Psycopg2TracedCursor, self)._trace_method(method, name, resource, extra_tags, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 73, in _trace_method
    return method(*args, **kwargs)
psycopg2.errors.AdminShutdown: terminating connection due to administrator command
SSL connection has been closed unexpectedly


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File \""/orm/service/./usage/calculators/heron.py\"", line 42, in epub_chapter_calculator
    content, content_created = usage.models.Content.objects.get_or_create(
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/manager.py\"", line 85, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/query.py\"", line 581, in get_or_create
    return self.get(**kwargs), False
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/query.py\"", line 431, in get
    num = len(clone)
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/query.py\"", line 262, in __len__
    self._fetch_all()
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/query.py\"", line 1324, in _fetch_all
    self._result_cache = list(self._iterable_class(self))
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/query.py\"", line 51, in __iter__
    results = compiler.execute_sql(chunked_fetch=self.chunked_fetch, chunk_size=self.chunk_size)
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/sql/compiler.py\"", line 1175, in execute_sql
    cursor.execute(sql, params)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 110, in execute
    return self._trace_method(self.__wrapped__.execute, self._self_datadog_name, query, {}, query, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/psycopg/patch.py\"", line 59, in _trace_method
    return super(Psycopg2TracedCursor, self)._trace_method(method, name, resource, extra_tags, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 73, in _trace_method
    return method(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/sentry_sdk/integrations/django/__init__.py\"", line 500, in execute
    return real_execute(self, sql, params)
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 66, in execute
    return self._execute_with_wrappers(sql, params, many=False, executor=self._execute)
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 75, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 84, in _execute
    return self.cursor.execute(sql, params)
  File \""/usr/local/lib/python3.9/site-packages/django/db/utils.py\"", line 90, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 84, in _execute
    return self.cursor.execute(sql, params)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 110, in execute
    return self._trace_method(self.__wrapped__.execute, self._self_datadog_name, query, {}, query, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/psycopg/patch.py\"", line 59, in _trace_method
    return super(Psycopg2TracedCursor, self)._trace_method(method, name, resource, extra_tags, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 73, in _trace_method
    return method(*args, **kwargs)
django.db.utils.OperationalError: terminating connection due to administrator command
SSL connection has been closed unexpectedly


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/base/base.py\"", line 219, in ensure_connection
    self.connect()
  File \""/usr/local/lib/python3.9/site-packages/django/utils/asyncio.py\"", line 26, in inner
    return func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/base/base.py\"", line 200, in connect
    self.connection = self.get_new_connection(conn_params)
  File \""/usr/local/lib/python3.9/site-packages/django/utils/asyncio.py\"", line 26, in inner
    return func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/postgresql/base.py\"", line 187, in get_new_connection
    connection = Database.connect(**conn_params)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/psycopg/patch.py\"", line 122, in patched_connect
    conn = connect_func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py\"", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
psycopg2.OperationalError: FATAL:  the database system is shutting down
FATAL:  the database system is shutting down


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File \""/usr/local/lib/python3.9/site-packages/django/core/handlers/exception.py\"", line 47, in inner
    response = get_response(request)
  File \""/usr/local/lib/python3.9/site-packages/django/core/handlers/base.py\"", line 181, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File \""/usr/local/lib/python3.9/site-packages/sentry_sdk/integrations/django/views.py\"", line 67, in sentry_wrapped_callback
    return callback(request, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/trace_utils.py\"", line 162, in wrapper
    return func(mod, pin, wrapped, instance, args, kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/django/patch.py\"", line 211, in wrapped
    return func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/django/views/decorators/csrf.py\"", line 54, in wrapped_view
    return view_func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/viewsets.py\"", line 125, in view
    return self.dispatch(request, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/trace_utils.py\"", line 162, in wrapper
    return func(mod, pin, wrapped, instance, args, kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/django/patch.py\"", line 211, in wrapped
    return func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/views.py\"", line 509, in dispatch
    response = self.handle_exception(exc)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/trace_utils.py\"", line 162, in wrapper
    return func(mod, pin, wrapped, instance, args, kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/django/restframework.py\"", line 19, in _traced_handle_exception
    return wrapped(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/views.py\"", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/views.py\"", line 480, in raise_unc{""asctime"":""2021-12-02T13:14:57+0000"", ""message"":""[pid: 8|app: 0|req: 135629/248166] 111.192.242.75 () {110 vars in 6955 bytes} [Thu Dec  2 13:14:57 2021] POST /api/v2/usage-event/ => generated 145 bytes in 282 msecs (HTTP/1.1 500) 9 headers in 396 bytes (1 switches on core 0)""}"
2021-12-02T13:14:57.628Z,gke-platform-prod-cluster-np-01-bffac76f-aif6.c.platform-prod-399563.internal,coot:http,"{""asctime"": ""2021-12-02T13:14:57.398"", ""module"": ""log"", ""levelname"": ""ERROR"", ""message"": ""Internal Server Error: /api/v2/usage-event/"", ""exc_info"": ""Traceback (most recent call last):
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 84, in _execute
    return self.cursor.execute(sql, params)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 110, in execute
    return self._trace_method(self.__wrapped__.execute, self._self_datadog_name, query, {}, query, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/psycopg/patch.py\"", line 59, in _trace_method
    return super(Psycopg2TracedCursor, self)._trace_method(method, name, resource, extra_tags, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 73, in _trace_method
    return method(*args, **kwargs)
psycopg2.errors.AdminShutdown: terminating connection due to administrator command
SSL connection has been closed unexpectedly


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File \""/orm/service/./usage/calculators/heron.py\"", line 42, in epub_chapter_calculator
    content, content_created = usage.models.Content.objects.get_or_create(
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/manager.py\"", line 85, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/query.py\"", line 581, in get_or_create
    return self.get(**kwargs), False
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/query.py\"", line 431, in get
    num = len(clone)
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/query.py\"", line 262, in __len__
    self._fetch_all()
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/query.py\"", line 1324, in _fetch_all
    self._result_cache = list(self._iterable_class(self))
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/query.py\"", line 51, in __iter__
    results = compiler.execute_sql(chunked_fetch=self.chunked_fetch, chunk_size=self.chunk_size)
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/sql/compiler.py\"", line 1175, in execute_sql
    cursor.execute(sql, params)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 110, in execute
    return self._trace_method(self.__wrapped__.execute, self._self_datadog_name, query, {}, query, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/psycopg/patch.py\"", line 59, in _trace_method
    return super(Psycopg2TracedCursor, self)._trace_method(method, name, resource, extra_tags, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 73, in _trace_method
    return method(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/sentry_sdk/integrations/django/__init__.py\"", line 500, in execute
    return real_execute(self, sql, params)
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 66, in execute
    return self._execute_with_wrappers(sql, params, many=False, executor=self._execute)
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 75, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 84, in _execute
    return self.cursor.execute(sql, params)
  File \""/usr/local/lib/python3.9/site-packages/django/db/utils.py\"", line 90, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 84, in _execute
    return self.cursor.execute(sql, params)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 110, in execute
    return self._trace_method(self.__wrapped__.execute, self._self_datadog_name, query, {}, query, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/psycopg/patch.py\"", line 59, in _trace_method
    return super(Psycopg2TracedCursor, self)._trace_method(method, name, resource, extra_tags, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 73, in _trace_method
    return method(*args, **kwargs)
django.db.utils.OperationalError: terminating connection due to administrator command
SSL connection has been closed unexpectedly


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/base/base.py\"", line 219, in ensure_connection
    self.connect()
  File \""/usr/local/lib/python3.9/site-packages/django/utils/asyncio.py\"", line 26, in inner
    return func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/base/base.py\"", line 200, in connect
    self.connection = self.get_new_connection(conn_params)
  File \""/usr/local/lib/python3.9/site-packages/django/utils/asyncio.py\"", line 26, in inner
    return func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/postgresql/base.py\"", line 187, in get_new_connection
    connection = Database.connect(**conn_params)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/psycopg/patch.py\"", line 122, in patched_connect
    conn = connect_func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py\"", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
psycopg2.OperationalError: FATAL:  the database system is shutting down
FATAL:  the database system is shutting down


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File \""/usr/local/lib/python3.9/site-packages/django/core/handlers/exception.py\"", line 47, in inner
    response = get_response(request)
  File \""/usr/local/lib/python3.9/site-packages/django/core/handlers/base.py\"", line 181, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File \""/usr/local/lib/python3.9/site-packages/sentry_sdk/integrations/django/views.py\"", line 67, in sentry_wrapped_callback
    return callback(request, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/trace_utils.py\"", line 162, in wrapper
    return func(mod, pin, wrapped, instance, args, kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/django/patch.py\"", line 211, in wrapped
    return func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/django/views/decorators/csrf.py\"", line 54, in wrapped_view
    return view_func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/viewsets.py\"", line 125, in view
    return self.dispatch(request, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/trace_utils.py\"", line 162, in wrapper
    return func(mod, pin, wrapped, instance, args, kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/django/patch.py\"", line 211, in wrapped
    return func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/views.py\"", line 509, in dispatch
    response = self.handle_exception(exc)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/trace_utils.py\"", line 162, in wrapper
    return func(mod, pin, wrapped, instance, args, kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/django/restframework.py\"", line 19, in _traced_handle_exception
    return wrapped(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/views.py\"", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/views.py\"", line 480, in raise_unc{""asctime"":""2021-12-02T13:14:57+0000"", ""message"":""[pid: 6|app: 0|req: 112537/248165] 183.83.212.6 () {108 vars in 6813 bytes} [Thu Dec  2 13:14:57 2021] POST /api/v2/usage-event/ => generated 145 bytes in 187 msecs (HTTP/1.1 500) 9 headers in 396 bytes (1 switches on core 0)""}"
2021-12-02T13:14:57.514Z,gke-platform-prod-cluster-np-01-3fe7d044-hcir.c.platform-prod-399563.internal,coot:http,"{""asctime"": ""2021-12-02T13:14:57.205"", ""module"": ""log"", ""levelname"": ""ERROR"", ""message"": ""Internal Server Error: /api/v2/usage-event/"", ""exc_info"": ""Traceback (most recent call last):
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 84, in _execute
    return self.cursor.execute(sql, params)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 110, in execute
    return self._trace_method(self.__wrapped__.execute, self._self_datadog_name, query, {}, query, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/psycopg/patch.py\"", line 59, in _trace_method
    return super(Psycopg2TracedCursor, self)._trace_method(method, name, resource, extra_tags, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 73, in _trace_method
    return method(*args, **kwargs)
psycopg2.errors.AdminShutdown: terminating connection due to administrator command
SSL connection has been closed unexpectedly


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File \""/usr/local/lib/python3.9/site-packages/django/core/handlers/exception.py\"", line 47, in inner
    response = get_response(request)
  File \""/usr/local/lib/python3.9/site-packages/django/core/handlers/base.py\"", line 181, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File \""/usr/local/lib/python3.9/site-packages/sentry_sdk/integrations/django/views.py\"", line 67, in sentry_wrapped_callback
    return callback(request, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/trace_utils.py\"", line 162, in wrapper
    return func(mod, pin, wrapped, instance, args, kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/django/patch.py\"", line 211, in wrapped
    return func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/django/views/decorators/csrf.py\"", line 54, in wrapped_view
    return view_func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/viewsets.py\"", line 125, in view
    return self.dispatch(request, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/trace_utils.py\"", line 162, in wrapper
    return func(mod, pin, wrapped, instance, args, kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/django/patch.py\"", line 211, in wrapped
    return func(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/views.py\"", line 509, in dispatch
    response = self.handle_exception(exc)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/trace_utils.py\"", line 162, in wrapper
    return func(mod, pin, wrapped, instance, args, kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/django/restframework.py\"", line 19, in _traced_handle_exception
    return wrapped(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/views.py\"", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/views.py\"", line 480, in raise_uncaught_exception
    raise exc
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/views.py\"", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File \""/orm/service/./api/viewsets.py\"", line 70, in create
    self.perform_create(serializer)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/mixins.py\"", line 24, in perform_create
    serializer.save()
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/serializers.py\"", line 708, in save
    self.instance = self.create(validated_data)
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/serializers.py\"", line 680, in create
    return [
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/serializers.py\"", line 681, in <listcomp>
    self.child.create(attrs) for attrs in validated_data
  File \""/usr/local/lib/python3.9/site-packages/rest_framework/serializers.py\"", line 939, in create
    instance = ModelClass._default_manager.create(**validated_data)
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/manager.py\"", line 85, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/query.py\"", line 453, in create
    obj.save(force_insert=True, using=self.db)
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/base.py\"", line 726, in save
    self.save_base(using=using, force_insert=force_insert,
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/base.py\"", line 763, in save_base
    updated = self._save_table(
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/base.py\"", line 868, in _save_table
    results = self._do_insert(cls._base_manager, using, fields, returning_fields, raw)
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/base.py\"", line 906, in _do_insert
    return manager._insert(
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/manager.py\"", line 85, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/query.py\"", line 1270, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
  File \""/usr/local/lib/python3.9/site-packages/django/db/models/sql/compiler.py\"", line 1416, in execute_sql
    cursor.execute(sql, params)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 110, in execute
    return self._trace_method(self.__wrapped__.execute, self._self_datadog_name, query, {}, query, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/psycopg/patch.py\"", line 59, in _trace_method
    return super(Psycopg2TracedCursor, self)._trace_method(method, name, resource, extra_tags, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 73, in _trace_method
    return method(*args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/sentry_sdk/integrations/django/__init__.py\"", line 500, in execute
    return real_execute(self, sql, params)
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 66, in execute
    return self._execute_with_wrappers(sql, params, many=False, executor=self._execute)
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 75, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 84, in _execute
    return self.cursor.execute(sql, params)
  File \""/usr/local/lib/python3.9/site-packages/django/db/utils.py\"", line 90, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File \""/usr/local/lib/python3.9/site-packages/django/db/backends/utils.py\"", line 84, in _execute
    return self.cursor.execute(sql, params)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 110, in execute
    return self._trace_method(self.__wrapped__.execute, self._self_datadog_name, query, {}, query, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/psycopg/patch.py\"", line 59, in _trace_method
    return super(Psycopg2TracedCursor, self)._trace_method(method, name, resource, extra_tags, *args, **kwargs)
  File \""/usr/local/lib/python3.9/site-packages/ddtrace/contrib/dbapi/__init__.py\"", line 73, in _trace_method
    return method(*args, **kwargs)
django.db.utils.OperationalError: terminating connection due to administrator command
SSL connection has been closed unexpectedly
"", ""status_code"": 500, ""request"": ""<WSGIRequest: POST '/api/v2/usage-event/'>"", ""dd.version"": ""main-202110211704-18-7a339974"", ""dd.env"": ""prod-gke"", ""dd.service"": ""coot:http"", ""dd.trace_id"": ""103300{""asctime"":""2021-12-02T13:14:57+0000"", ""message"":""[pid: 8|app: 0|req: 13507884/24379592] 49.206.12.26 () {110 vars in 5801 bytes} [Thu Dec  2 13:14:57 2021] POST /api/v2/usage-event/ => generated 145 bytes in 55 msecs (HTTP/1.1 500) 9 headers in 396 bytes (1 switches on core 0)""}"
